(()=>{var e={};e.id=618,e.ids=[618],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},5298:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>o});var l=s(482),a=s(9108),r=s(2563),n=s.n(r),i=s(8300),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let o=["",{children:["games",{children:["infiltre",{children:["[code]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4651)),"C:\\Users\\masso\\Desktop\\IttolecHub\\app\\games\\infiltre\\[code]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,5560)),"C:\\Users\\masso\\Desktop\\IttolecHub\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\masso\\Desktop\\IttolecHub\\app\\games\\infiltre\\[code]\\page.tsx"],x="/games/infiltre/[code]/page",u={require:s,loadChunk:()=>Promise.resolve()},m=new l.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/games/infiltre/[code]/page",pathname:"/games/infiltre/[code]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},6536:(e,t,s)=>{Promise.resolve().then(s.bind(s,6741))},6741:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var l=s(5344),a=s(3729),r=s(3511),n=s(1973),i=s(6824),d=s(3485),o=s(8822),c=s(1222),x=s(4755);function u({roomCode:e}){let{gameState:t,isHost:s,players:u,playerId:m,startGame:p,updateRoundData:h,nextRound:f,submitAnswer:g}=(0,n.d)(e,"infiltre"),[b,j]=(0,a.useState)(0),[N,w]=(0,a.useState)(null),v=t?.round_data||{},y=v.queue||[],I=v.phase||"roles",M=v.roles||{},k=m?M[m]:void 0,E=t?.answers||{},T=m&&E[m]?E[m].answer:null,{word:A,category:C,lastAnswer:R,winner:q,voteResult:S}=v;(0,a.useEffect)(()=>{if(t?.round_data?.countdown){let e=Math.ceil((t.round_data.countdown-Date.now())/1e3);if(e>0){w(e);let t=setInterval(()=>{w(e=>e&&e>1?e-1:0)},1e3);return()=>clearInterval(t)}w(null)}else w(null)},[t?.round_data?.countdown]);let _=async()=>{if(!s)return;let e=Date.now()+3e3;await h({...v,countdown:e}),setTimeout(async()=>{try{let e=await fetch("/api/games/infiltre?count=20"),t=await e.json();if(!Array.isArray(t)){x.Am.error("Erreur chargement mots");return}let s=t[0],l=t.slice(1),a=[...u].sort(()=>Math.random()-.5),r=a[0],n=a[1],i={};u.forEach(e=>{r&&e.id===r.id?i[e.id]="MASTER":n&&e.id===n.id?i[e.id]="INFILTR\xc9":i[e.id]="CITOYEN"}),await h({...v,countdown:null}),await p({queue:l,word:s.word,category:s.category,roles:i,phase:"question",lastAnswer:null,voteResult:null,winner:null})}catch(e){console.error(e),x.Am.error("Impossible de d\xe9marrer")}},3e3)},L=async()=>{if(!s)return;if(0===y.length){_();return}let e=y[0],t=y.slice(1),l=[...u].sort(()=>Math.random()-.5),a=l[0],r=l[1],n={};u.forEach(e=>{e.id===a?.id?n[e.id]="MASTER":e.id===r?.id?n[e.id]="INFILTR\xc9":n[e.id]="CITOYEN"}),await f({queue:t,word:e.word,category:e.category,roles:n,phase:"question",lastAnswer:null,voteResult:null,winner:null})},P=e=>{"MASTER"===k&&h({...v,lastAnswer:e})},D=async e=>{m&&e&&await g(e)},F=async()=>{if(!s)return;let e={};Object.values(E).forEach(t=>{let s=t.answer;s&&(e[s]=(e[s]||0)+1)});let t=0,l=null;Object.entries(e).forEach(([e,s])=>{s>t&&(t=s,l=e)});let a=Object.keys(M).find(e=>"INFILTR\xc9"===M[e]),r=l===a;h({...v,phase:"end",voteResult:l,winner:r?"CITOYENS":"INFILTR\xc9"})},O=(0,a.useMemo)(()=>{let e=Math.floor(b/60),t=b%60;return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},[b]),z=l.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-1",children:u.map(e=>(0,l.jsxs)("div",{className:`flex items-center gap-2 px-3 py-2 rounded-full border text-sm shrink-0 ${"vote"===I&&T===e.id?"bg-indigo-600 border-indigo-500 text-slate-50":"bg-slate-900 border-slate-800 text-slate-50"}`,children:[l.jsx("div",{className:"h-7 w-7 rounded-full bg-indigo-600 flex items-center justify-center text-xs font-semibold",children:e.name.charAt(0).toUpperCase()}),l.jsx("span",{className:"font-medium max-w-[120px] truncate",children:e.name}),"end"===I&&"INFILTR\xc9"===M[e.id]&&l.jsx("span",{className:"text-[10px] bg-red-500 text-white px-1 rounded",children:"INF"}),"end"===I&&"MASTER"===M[e.id]&&l.jsx("span",{className:"text-[10px] bg-blue-500 text-white px-1 rounded",children:"GM"})]},e.id))}),Z=(0,l.jsxs)("div",{className:"flex flex-col gap-3 bg-slate-900 p-4 rounded-2xl w-full border border-slate-800",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("span",{className:"text-slate-400 font-medium text-sm",children:["L'Infiltr\xe9 • Room ",e]}),l.jsx("span",{className:"text-xs text-slate-500 capitalize",children:I})]}),"question"===I&&(0,l.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[l.jsx("span",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Temps restant"}),l.jsx("span",{className:"text-2xl font-bold text-indigo-400 tabular-nums",children:O}),l.jsx("div",{className:"w-full bg-slate-800 rounded-full h-1.5 overflow-hidden mt-1",children:l.jsx("div",{className:"h-full bg-indigo-600 transition-all duration-1000",style:{width:`${Math.max(0,b/180*100)}%`}})})]})]}),U=l.jsx("div",{className:"bg-slate-900 rounded-3xl p-6 border border-slate-800 flex flex-col items-center text-center w-full shadow-xl",children:"roles"===I?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center py-10",children:[l.jsx(d.Z,{className:"h-16 w-16 text-slate-700 mb-4"}),l.jsx("h2",{className:"text-xl font-bold text-slate-200 mb-2",children:"En attente"}),l.jsx("p",{className:"text-slate-400 text-sm max-w-xs",children:"Le Ma\xeetre du jeu va lancer la partie et distribuer les r\xf4les."})]}):(0,l.jsxs)(l.Fragment,{children:[l.jsx("p",{className:"text-xs text-slate-400 mb-2 uppercase tracking-wide",children:"Ton r\xf4le"}),(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-600 flex items-center justify-center",children:"MASTER"===k?l.jsx(d.Z,{className:"h-5 w-5 text-slate-50"}):l.jsx(o.Z,{className:"h-5 w-5 text-slate-50"})}),(0,l.jsxs)("div",{className:"text-left",children:[l.jsx("p",{className:"text-sm text-slate-400",children:"Tu es"}),l.jsx("p",{className:"text-lg font-semibold",children:"MASTER"===k?"Ma\xeetre du jeu":"INFILTR\xc9"===k?"Infiltr\xe9":"Citoyen"})]})]}),"MASTER"===k||"INFILTR\xc9"===k?(0,l.jsxs)("div",{className:"w-full rounded-2xl bg-slate-800 px-4 py-3 mb-4",children:[l.jsx("p",{className:"text-xs text-slate-400 mb-1 uppercase tracking-wide",children:"Mot secret"}),l.jsx("p",{className:"text-xl font-semibold text-slate-50",children:A??"---"}),C&&l.jsx("p",{className:"text-xs text-slate-400 mt-1",children:C})]}):(0,l.jsxs)("div",{className:"w-full rounded-2xl bg-slate-800 px-4 py-3 mb-4",children:[l.jsx("p",{className:"text-xs text-slate-400 mb-2 uppercase tracking-wide",children:"Mot secret inconnu"}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-slate-400 text-sm justify-center",children:[l.jsx(c.Z,{className:"h-4 w-4"}),l.jsx("span",{children:"Pose des questions au Ma\xeetre !"})]})]}),"question"===I&&(0,l.jsxs)("div",{className:"w-full flex flex-col items-center gap-3",children:["MASTER"===k?l.jsx("div",{className:"flex flex-col gap-2 w-full",children:(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[l.jsx(r.z,{className:"rounded-2xl bg-emerald-500 hover:bg-emerald-400 text-slate-950 text-sm py-2",onClick:()=>P("yes"),children:"Oui"}),l.jsx(r.z,{className:"rounded-2xl bg-rose-500 hover:bg-rose-400 text-slate-950 text-sm py-2",onClick:()=>P("no"),children:"Non"}),l.jsx(r.z,{className:"rounded-2xl bg-slate-700 hover:bg-slate-600 text-slate-50 text-sm py-2",onClick:()=>P("maybe"),children:"???"})]})}):l.jsx("div",{className:"text-xs text-slate-500",children:"Attends les r\xe9ponses du Ma\xeetre du jeu."}),R&&(0,l.jsxs)("div",{className:"mt-2 px-3 py-1.5 rounded-full bg-slate-800 text-xs text-slate-200 flex items-center gap-2",children:[l.jsx("span",{className:"font-medium text-slate-400",children:"Derni\xe8re r\xe9ponse :"}),l.jsx("span",{className:"uppercase tracking-wide font-bold text-white",children:"yes"===R?"OUI":"no"===R?"NON":"JE NE SAIS PAS"})]})]}),"vote"===I&&(0,l.jsxs)("div",{className:"w-full",children:[l.jsx("p",{className:"text-sm text-slate-200 mb-2 font-medium",children:"Votez pour d\xe9masquer l'Infiltr\xe9 !"}),l.jsx("div",{className:"flex flex-wrap gap-2 justify-center mt-4",children:u.map(e=>l.jsx("button",{type:"button",onClick:()=>D(e.id),className:`px-4 py-2 rounded-full text-sm border transition-all ${T===e.id?"bg-indigo-600 border-indigo-500 text-white scale-105 shadow-lg shadow-indigo-500/20":"bg-slate-800 border-slate-700 text-slate-300 hover:bg-slate-700"}`,children:e.name},e.id))}),l.jsx("p",{className:"text-xs text-slate-500 mt-4",children:"Le Ma\xeetre du jeu cl\xf4turera le vote."})]}),"end"===I&&(0,l.jsxs)("div",{className:"w-full",children:[l.jsx("p",{className:"text-2xl font-bold text-white mb-2",children:"CITOYENS"===q?"\uD83C\uDF89 Les Citoyens gagnent !":"\uD83D\uDD75️ L'Infiltr\xe9 gagne !"}),(0,l.jsxs)("div",{className:"bg-slate-800 rounded-xl p-4 mt-4 text-left space-y-2",children:[(0,l.jsxs)("p",{className:"text-sm text-slate-400",children:["L'Infiltr\xe9 \xe9tait : ",l.jsx("span",{className:"text-white font-bold",children:u.find(e=>"INFILTR\xc9"===M[e.id])?.name||"Inconnu"})]}),(0,l.jsxs)("p",{className:"text-sm text-slate-400",children:["Le suspect vot\xe9 : ",l.jsx("span",{className:"text-white font-bold",children:u.find(e=>e.id===S)?.name||"Aucun"})]}),(0,l.jsxs)("p",{className:"text-sm text-slate-400",children:["Le mot \xe9tait : ",l.jsx("span",{className:"text-white font-bold",children:A})]})]})]})]})}),$=(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[s&&(0,l.jsxs)(l.Fragment,{children:["roles"===I&&l.jsx(r.z,{onClick:_,className:"w-full rounded-2xl bg-indigo-600 hover:bg-indigo-500 text-slate-50 py-3 text-base",disabled:u.length<3,children:"Distribuer les r\xf4les & d\xe9marrer"}),"question"===I&&l.jsx(r.z,{onClick:()=>{s&&h({...v,phase:"vote"})},className:"w-full rounded-2xl bg-rose-600 hover:bg-rose-500 text-slate-50 py-3 text-base",children:"Lancer le vote (Fin du temps)"}),"vote"===I&&l.jsx(r.z,{onClick:F,className:"w-full rounded-2xl bg-indigo-600 hover:bg-indigo-500 text-slate-50 py-3 text-base",children:"Cl\xf4turer le vote"}),"end"===I&&l.jsx(r.z,{onClick:L,className:"w-full rounded-2xl bg-emerald-600 hover:bg-emerald-500 text-slate-50 py-3 text-base",children:"Manche suivante"})]}),!s&&"roles"===I&&l.jsx("p",{className:"text-xs text-slate-500 text-center",children:"En attente de l'h\xf4te..."})]});return l.jsx(i.Z,{header:Z,main:U,footer:$,playersBar:z})}function m({params:e,searchParams:t}){return l.jsx(u,{roomCode:e.code})}},3485:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(9224).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},8822:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(9224).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},4651:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>r,__esModule:()=>a,default:()=>n});let l=(0,s(6843).createProxy)(String.raw`C:\Users\masso\Desktop\IttolecHub\app\games\infiltre\[code]\page.tsx`),{__esModule:a,$$typeof:r}=l,n=l.default}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),l=t.X(0,[638,643,373,616,147,466],()=>s(5298));module.exports=l})();