(()=>{var e={};e.id=618,e.ids=[618],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},5298:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>o});var l=s(482),a=s(9108),r=s(2563),n=s.n(r),i=s(8300),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let o=["",{children:["games",{children:["infiltre",{children:["[code]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4651)),"C:\\Users\\masso\\Desktop\\IttolecHub\\app\\games\\infiltre\\[code]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,5560)),"C:\\Users\\masso\\Desktop\\IttolecHub\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\masso\\Desktop\\IttolecHub\\app\\games\\infiltre\\[code]\\page.tsx"],x="/games/infiltre/[code]/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new l.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/games/infiltre/[code]/page",pathname:"/games/infiltre/[code]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},6536:(e,t,s)=>{Promise.resolve().then(s.bind(s,6741))},6741:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var l=s(5344),a=s(3729),r=s(3511),n=s(2368),i=s(6824),d=s(3485),o=s(8822),c=s(1222),x=s(4755);function m({roomCode:e}){let{gameState:t,isHost:s,players:m,playerId:u,startGame:p,updateRoundData:h,nextRound:f,submitAnswer:g}=(0,n.d)(e,"infiltre"),[b,j]=(0,a.useState)(0),N=t?.round_data||{},v=N.phase||"roles",w=N.roles||{},y=N.word,I=N.category,E=N.lastAnswer,M=N.voteResult,A=N.winner,k=N.queue||[],q=(t?.settings?.time?parseInt(t.settings.time,10):180)||180,C=u?w[u]:void 0,T=t?.answers||{},R=u&&T[u]?T[u].answer:null;(0,a.useEffect)(()=>{"question"===v&&j(q)},[v,q]),(0,a.useEffect)(()=>{let e;return"question"===v&&b>0&&(e=setInterval(()=>{j(e=>e<=1?0:e-1)},1e3)),()=>clearInterval(e)},[v,b]),(0,a.useEffect)(()=>{s&&"question"===v&&0===b&&h({...N,phase:"vote"})},[s,v,b,N,h]);let S=async()=>{if(s)try{let e=await fetch("/api/games/infiltre?count=20"),t=await e.json();if(!Array.isArray(t)){x.Am.error("Erreur chargement mots");return}let s=t[0],l=t.slice(1),a=[...m].sort(()=>Math.random()-.5);a.length;let r=a[0],n=a[1],i={};m.forEach(e=>{e.id===r?.id?i[e.id]="MASTER":e.id===n?.id?i[e.id]="INFILTR\xc9":i[e.id]="CITOYEN"}),await p({queue:l,word:s.word,category:s.category,roles:i,phase:"question",lastAnswer:null,voteResult:null,winner:null})}catch(e){console.error(e),x.Am.error("Impossible de d\xe9marrer")}},_=async()=>{if(!s)return;if(0===k.length){S();return}let e=k[0],t=k.slice(1),l=[...m].sort(()=>Math.random()-.5),a=l[0],r=l[1],n={};m.forEach(e=>{e.id===a?.id?n[e.id]="MASTER":e.id===r?.id?n[e.id]="INFILTR\xc9":n[e.id]="CITOYEN"}),await f({queue:t,word:e.word,category:e.category,roles:n,phase:"question",lastAnswer:null,voteResult:null,winner:null})},L=e=>{"MASTER"===C&&h({...N,lastAnswer:e})},P=async e=>{u&&e&&await g(e)},F=async()=>{if(!s)return;let e={};Object.values(T).forEach(t=>{let s=t.answer;s&&(e[s]=(e[s]||0)+1)});let t=0,l=null;Object.entries(e).forEach(([e,s])=>{s>t&&(t=s,l=e)});let a=Object.keys(w).find(e=>"INFILTR\xc9"===w[e]),r=l===a;h({...N,phase:"end",voteResult:l,winner:r?"CITOYENS":"INFILTR\xc9"})},D=(0,a.useMemo)(()=>{let e=Math.floor(b/60),t=b%60;return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},[b]),O=l.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-1",children:m.map(e=>(0,l.jsxs)("div",{className:`flex items-center gap-2 px-3 py-2 rounded-full border text-sm shrink-0 ${"vote"===v&&R===e.id?"bg-indigo-600 border-indigo-500 text-slate-50":"bg-slate-900 border-slate-800 text-slate-50"}`,children:[l.jsx("div",{className:"h-7 w-7 rounded-full bg-indigo-600 flex items-center justify-center text-xs font-semibold",children:e.name.charAt(0).toUpperCase()}),l.jsx("span",{className:"font-medium max-w-[120px] truncate",children:e.name}),"end"===v&&"INFILTR\xc9"===w[e.id]&&l.jsx("span",{className:"text-[10px] bg-red-500 text-white px-1 rounded",children:"INF"}),"end"===v&&"MASTER"===w[e.id]&&l.jsx("span",{className:"text-[10px] bg-blue-500 text-white px-1 rounded",children:"GM"})]},e.id))}),z=(0,l.jsxs)("div",{className:"flex flex-col gap-3 bg-slate-900 p-4 rounded-2xl w-full border border-slate-800",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("span",{className:"text-slate-400 font-medium text-sm",children:["L'Infiltr\xe9 • Room ",e]}),l.jsx("span",{className:"text-xs text-slate-500 capitalize",children:v})]}),"question"===v&&(0,l.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[l.jsx("span",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Temps restant"}),l.jsx("span",{className:"text-2xl font-bold text-indigo-400 tabular-nums",children:D}),l.jsx("div",{className:"w-full bg-slate-800 rounded-full h-1.5 overflow-hidden mt-1",children:l.jsx("div",{className:"h-full bg-indigo-600 transition-all duration-1000",style:{width:`${Math.max(0,b/q*100)}%`}})})]})]}),Z=l.jsx("div",{className:"bg-slate-900 rounded-3xl p-6 border border-slate-800 flex flex-col items-center text-center w-full shadow-xl",children:"roles"===v?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center py-10",children:[l.jsx(d.Z,{className:"h-16 w-16 text-slate-700 mb-4"}),l.jsx("h2",{className:"text-xl font-bold text-slate-200 mb-2",children:"En attente"}),l.jsx("p",{className:"text-slate-400 text-sm max-w-xs",children:"Le Ma\xeetre du jeu va lancer la partie et distribuer les r\xf4les."})]}):(0,l.jsxs)(l.Fragment,{children:[l.jsx("p",{className:"text-xs text-slate-400 mb-2 uppercase tracking-wide",children:"Ton r\xf4le"}),(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-600 flex items-center justify-center",children:"MASTER"===C?l.jsx(d.Z,{className:"h-5 w-5 text-slate-50"}):l.jsx(o.Z,{className:"h-5 w-5 text-slate-50"})}),(0,l.jsxs)("div",{className:"text-left",children:[l.jsx("p",{className:"text-sm text-slate-400",children:"Tu es"}),l.jsx("p",{className:"text-lg font-semibold",children:"MASTER"===C?"Ma\xeetre du jeu":"INFILTR\xc9"===C?"Infiltr\xe9":"Citoyen"})]})]}),"MASTER"===C||"INFILTR\xc9"===C?(0,l.jsxs)("div",{className:"w-full rounded-2xl bg-slate-800 px-4 py-3 mb-4",children:[l.jsx("p",{className:"text-xs text-slate-400 mb-1 uppercase tracking-wide",children:"Mot secret"}),l.jsx("p",{className:"text-xl font-semibold text-slate-50",children:y??"---"}),I&&l.jsx("p",{className:"text-xs text-slate-400 mt-1",children:I})]}):(0,l.jsxs)("div",{className:"w-full rounded-2xl bg-slate-800 px-4 py-3 mb-4",children:[l.jsx("p",{className:"text-xs text-slate-400 mb-2 uppercase tracking-wide",children:"Mot secret inconnu"}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-slate-400 text-sm justify-center",children:[l.jsx(c.Z,{className:"h-4 w-4"}),l.jsx("span",{children:"Pose des questions au Ma\xeetre !"})]})]}),"question"===v&&(0,l.jsxs)("div",{className:"w-full flex flex-col items-center gap-3",children:["MASTER"===C?l.jsx("div",{className:"flex flex-col gap-2 w-full",children:(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[l.jsx(r.z,{className:"rounded-2xl bg-emerald-500 hover:bg-emerald-400 text-slate-950 text-sm py-2",onClick:()=>L("yes"),children:"Oui"}),l.jsx(r.z,{className:"rounded-2xl bg-rose-500 hover:bg-rose-400 text-slate-950 text-sm py-2",onClick:()=>L("no"),children:"Non"}),l.jsx(r.z,{className:"rounded-2xl bg-slate-700 hover:bg-slate-600 text-slate-50 text-sm py-2",onClick:()=>L("maybe"),children:"???"})]})}):l.jsx("div",{className:"text-xs text-slate-500",children:"Attends les r\xe9ponses du Ma\xeetre du jeu."}),E&&(0,l.jsxs)("div",{className:"mt-2 px-3 py-1.5 rounded-full bg-slate-800 text-xs text-slate-200 flex items-center gap-2",children:[l.jsx("span",{className:"font-medium text-slate-400",children:"Derni\xe8re r\xe9ponse :"}),l.jsx("span",{className:"uppercase tracking-wide font-bold text-white",children:"yes"===E?"OUI":"no"===E?"NON":"JE NE SAIS PAS"})]})]}),"vote"===v&&(0,l.jsxs)("div",{className:"w-full",children:[l.jsx("p",{className:"text-sm text-slate-200 mb-2 font-medium",children:"Votez pour d\xe9masquer l'Infiltr\xe9 !"}),l.jsx("div",{className:"flex flex-wrap gap-2 justify-center mt-4",children:m.map(e=>l.jsx("button",{type:"button",onClick:()=>P(e.id),className:`px-4 py-2 rounded-full text-sm border transition-all ${R===e.id?"bg-indigo-600 border-indigo-500 text-white scale-105 shadow-lg shadow-indigo-500/20":"bg-slate-800 border-slate-700 text-slate-300 hover:bg-slate-700"}`,children:e.name},e.id))}),l.jsx("p",{className:"text-xs text-slate-500 mt-4",children:"Le Ma\xeetre du jeu cl\xf4turera le vote."})]}),"end"===v&&(0,l.jsxs)("div",{className:"w-full",children:[l.jsx("p",{className:"text-2xl font-bold text-white mb-2",children:"CITOYENS"===A?"\uD83C\uDF89 Les Citoyens gagnent !":"\uD83D\uDD75️ L'Infiltr\xe9 gagne !"}),(0,l.jsxs)("div",{className:"bg-slate-800 rounded-xl p-4 mt-4 text-left space-y-2",children:[(0,l.jsxs)("p",{className:"text-sm text-slate-400",children:["L'Infiltr\xe9 \xe9tait : ",l.jsx("span",{className:"text-white font-bold",children:m.find(e=>"INFILTR\xc9"===w[e.id])?.name||"Inconnu"})]}),(0,l.jsxs)("p",{className:"text-sm text-slate-400",children:["Le suspect vot\xe9 : ",l.jsx("span",{className:"text-white font-bold",children:m.find(e=>e.id===M)?.name||"Aucun"})]}),(0,l.jsxs)("p",{className:"text-sm text-slate-400",children:["Le mot \xe9tait : ",l.jsx("span",{className:"text-white font-bold",children:y})]})]})]})]})}),$=(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[s&&(0,l.jsxs)(l.Fragment,{children:["roles"===v&&l.jsx(r.z,{onClick:S,className:"w-full rounded-2xl bg-indigo-600 hover:bg-indigo-500 text-slate-50 py-3 text-base",disabled:m.length<3,children:"Distribuer les r\xf4les & d\xe9marrer"}),"question"===v&&l.jsx(r.z,{onClick:()=>{s&&h({...N,phase:"vote"})},className:"w-full rounded-2xl bg-rose-600 hover:bg-rose-500 text-slate-50 py-3 text-base",children:"Lancer le vote (Fin du temps)"}),"vote"===v&&l.jsx(r.z,{onClick:F,className:"w-full rounded-2xl bg-indigo-600 hover:bg-indigo-500 text-slate-50 py-3 text-base",children:"Cl\xf4turer le vote"}),"end"===v&&l.jsx(r.z,{onClick:_,className:"w-full rounded-2xl bg-emerald-600 hover:bg-emerald-500 text-slate-50 py-3 text-base",children:"Manche suivante"})]}),!s&&"roles"===v&&l.jsx("p",{className:"text-xs text-slate-500 text-center",children:"En attente de l'h\xf4te..."})]});return l.jsx(i.Z,{header:z,main:Z,footer:$,playersBar:O})}function u({params:e,searchParams:t}){return l.jsx(m,{roomCode:e.code})}},3485:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(9224).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},4651:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>r,__esModule:()=>a,default:()=>n});let l=(0,s(6843).createProxy)(String.raw`C:\Users\masso\Desktop\IttolecHub\app\games\infiltre\[code]\page.tsx`),{__esModule:a,$$typeof:r}=l,n=l.default}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),l=t.X(0,[456,77,301,469,147,626],()=>s(5298));module.exports=l})();