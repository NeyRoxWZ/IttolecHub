(()=>{var e={};e.id=618,e.ids=[618],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},5298:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>d});var l=s(482),a=s(9108),r=s(2563),n=s.n(r),i=s(8300),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d=["",{children:["games",{children:["infiltre",{children:["[code]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4651)),"C:\\Users\\masso\\Desktop\\IttolecHub\\app\\games\\infiltre\\[code]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,5560)),"C:\\Users\\masso\\Desktop\\IttolecHub\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\masso\\Desktop\\IttolecHub\\app\\games\\infiltre\\[code]\\page.tsx"],x="/games/infiltre/[code]/page",u={require:s,loadChunk:()=>Promise.resolve()},m=new l.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/games/infiltre/[code]/page",pathname:"/games/infiltre/[code]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},6536:(e,t,s)=>{Promise.resolve().then(s.bind(s,3925))},3925:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var l=s(5344),a=s(3729),r=s(3511),n=s(1973),i=s(6824),o=s(3485),d=s(7189),c=s(1222),x=s(9224);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,x.Z)("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var m=s(2312);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,x.Z)("Gavel",[["path",{d:"m14 13-7.5 7.5c-.83.83-2.17.83-3 0 0 0 0 0 0 0a2.12 2.12 0 0 1 0-3L11 10",key:"c9cbz0"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m9 7 8 8",key:"5jnvq1"}],["path",{d:"m21 11-8-8",key:"z4y7zo"}]]);var p=s(5961),b=s(2086),g=s(5299),f=s(8120),j=s(4755),v=s(2254);function w({roomCode:e}){let t=(0,v.useRouter)(),{gameState:s,isHost:x,players:w,playerId:N,startGame:y,updateRoundData:k,nextRound:I,submitAnswer:T}=(0,n.d)(e,"infiltre"),[M,C]=(0,a.useState)(0),[q,E]=(0,a.useState)(null),R=s?.round_data||{},z=R.queue||[],Z=R.phase||"roles",A=R.roles||{},L=N?A[N]:void 0,S=s?.answers||{},_=N&&S[N]?S[N].answer:null,{word:P,category:D,lastAnswer:O,winner:F,voteResult:$}=R,U=(0,a.useMemo)(()=>w.reduce((e,t)=>({...e,[t.name]:t.score}),{}),[w]);(0,a.useEffect)(()=>{if(s?.round_data?.countdown){let e=Math.ceil((s.round_data.countdown-Date.now())/1e3);if(e>0){E(e);let t=setInterval(()=>{E(e=>e&&e>1?e-1:0)},1e3);return()=>clearInterval(t)}E(null)}else E(null)},[s?.round_data?.countdown]),(0,a.useEffect)(()=>{if("question"===Z&&R.endTime){let e=Math.ceil((R.endTime-Date.now())/1e3);C(e>0?e:0);let t=setInterval(()=>{C(e=>e<=1?(x&&"question"===Z&&k({...R,phase:"end",winner:"INFILTR\xc9",voteResult:null}),0):e-1)},1e3);return()=>clearInterval(t)}},[Z,R.endTime,x]);let H=async()=>{if(!x)return;let e=Date.now()+3e3;await k({...R,countdown:e}),setTimeout(async()=>{try{let e=await fetch("/api/games/infiltre?count=20"),t=await e.json();if(!Array.isArray(t)){j.Am.error("Erreur chargement mots");return}let s=t[0],l=t.slice(1),a=[...w].sort(()=>Math.random()-.5),r=a[0],n=a[1],i={};w.forEach(e=>{r&&e.id===r.id?i[e.id]="MASTER":n&&e.id===n.id?i[e.id]="INFILTR\xc9":i[e.id]="CITOYEN"}),await k({...R,countdown:null}),await y({queue:l,word:s.word,category:s.category,roles:i,phase:"question",lastAnswer:null,voteResult:null,winner:null,endTime:Date.now()+18e4})}catch(e){console.error(e),j.Am.error("Impossible de d\xe9marrer")}},3e3)},Y=async()=>{if(!x)return;if(0===z.length){H();return}let e=z[0],t=z.slice(1),s=[...w].sort(()=>Math.random()-.5),l=s[0],a=s[1],r={};w.forEach(e=>{e.id===l?.id?r[e.id]="MASTER":e.id===a?.id?r[e.id]="INFILTR\xc9":r[e.id]="CITOYEN"}),await I({queue:t,word:e.word,category:e.category,roles:r,phase:"question",lastAnswer:null,voteResult:null,winner:null,endTime:Date.now()+18e4})},G=e=>{"MASTER"===L&&k({...R,lastAnswer:e})},V=async e=>{N&&e&&await T(e)},J=async()=>{"MASTER"===L&&k({...R,phase:"end",winner:"CITOYENS",voteResult:null})},Q=async()=>{if(!x)return;let e={};Object.values(S).forEach(t=>{let s=t.answer;s&&(e[s]=(e[s]||0)+1)});let t=0,s=null;Object.entries(e).forEach(([e,l])=>{l>t&&(t=l,s=e)});let l=Object.keys(A).find(e=>"INFILTR\xc9"===A[e]),a=s===l;k({...R,phase:"end",voteResult:s,winner:a?"CITOYENS":"INFILTR\xc9"})},X=(0,a.useMemo)(()=>{let e=Math.floor(M/60),t=M%60;return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},[M]);return l.jsx(i.Z,{gameTitle:"L'Infiltr\xe9",roundCount:0,maxRounds:0,timer:X,players:U,timeLeft:M,gameStarted:"roles"!==Z,children:(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center w-full max-w-4xl mx-auto gap-8 animate-in fade-in duration-700",children:[q&&l.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm animate-in fade-in duration-300",children:l.jsx("div",{className:"text-9xl font-black text-white animate-pulse",children:q})}),"roles"===Z?(0,l.jsxs)("div",{className:"flex flex-col items-center gap-6 text-center",children:[l.jsx("div",{className:"w-24 h-24 bg-indigo-500/20 rounded-full flex items-center justify-center animate-pulse",children:l.jsx(o.Z,{className:"w-12 h-12 text-indigo-400"})}),l.jsx("h2",{className:"text-3xl font-bold text-white",children:"Pr\xe9parez-vous \xe0 enqu\xeater"}),l.jsx("p",{className:"text-slate-400 max-w-md",children:"Un joueur est l'Infiltr\xe9. Il ne conna\xeet pas le mot secret. Les Citoyens doivent le d\xe9masquer sans trop en r\xe9v\xe9ler !"}),x?l.jsx(r.z,{onClick:H,size:"lg",className:"mt-4 bg-indigo-600 hover:bg-indigo-500 text-lg px-8 py-6 rounded-xl shadow-lg shadow-indigo-500/20",disabled:w.length<3,children:w.length<3?"En attente de joueurs (min 3)":"Distribuer les r\xf4les"}):(0,l.jsxs)("div",{className:"flex items-center gap-2 text-indigo-400 bg-indigo-950/30 px-4 py-2 rounded-full border border-indigo-500/30 animate-pulse",children:[l.jsx("div",{className:"w-2 h-2 bg-indigo-400 rounded-full"}),"En attente de l'h\xf4te..."]})]}):(0,l.jsxs)("div",{className:"w-full flex flex-col gap-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center bg-slate-900/50 p-4 rounded-xl border border-white/5",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-3 h-3 rounded-full animate-pulse ${"question"===Z?"bg-emerald-500":"bg-amber-500"}`}),l.jsx("span",{className:"text-sm font-bold uppercase tracking-widest text-slate-300",children:"question"===Z?"Phase de questions":"vote"===Z?"Phase de vote":"R\xe9sultats"})]}),"question"===Z&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-slate-400 font-mono",children:[l.jsx(d.Z,{className:"w-4 h-4"}),X]})]}),(0,l.jsxs)("div",{className:"w-full bg-slate-800/50 rounded-2xl p-6 border border-white/10 flex flex-col items-center text-center relative overflow-hidden group",children:[l.jsx("div",{className:`absolute inset-0 opacity-10 ${"MASTER"===L?"bg-blue-600":"INFILTR\xc9"===L?"bg-red-600":"bg-emerald-600"}`}),l.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-widest mb-2 z-10",children:"Votre r\xf4le"}),l.jsx("h3",{className:`text-3xl font-black mb-4 z-10 ${"MASTER"===L?"text-blue-400":"INFILTR\xc9"===L?"text-red-400":"text-emerald-400"}`,children:"MASTER"===L?"MA\xceTRE DU JEU":"INFILTR\xc9"===L?"INFILTR\xc9":"CITOYEN"}),l.jsx("div",{className:"bg-black/40 p-4 rounded-xl w-full max-w-sm backdrop-blur-sm border border-white/5 z-10",children:"MASTER"===L||"INFILTR\xc9"===L?(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[l.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest",children:"Le mot secret est"}),l.jsx("p",{className:"font-black text-2xl text-white tracking-tight",children:P}),D&&l.jsx("p",{className:"text-xs text-blue-400 bg-blue-500/10 px-2 py-1 rounded-full self-center",children:D})]}):(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[l.jsx(c.Z,{className:"w-8 h-8 text-slate-500 mx-auto mb-2"}),l.jsx("p",{className:"font-bold text-lg text-white",children:"Mot Secret Inconnu"}),l.jsx("p",{className:"text-sm text-slate-400",children:"Posez des questions pour le trouver !"})]})})]}),"question"===Z&&(0,l.jsxs)("div",{className:"flex flex-col items-center gap-6 animate-in slide-in-from-bottom-4 duration-500",children:[(0,l.jsxs)("div",{className:"w-full max-w-2xl bg-slate-900/50 rounded-2xl p-6 border border-white/5 text-center",children:[l.jsx(u,{className:"w-10 h-10 text-indigo-400 mx-auto mb-4"}),l.jsx("p",{className:"text-lg text-slate-300 mb-6",children:"Les joueurs posent des questions au Ma\xeetre du Jeu qui ne peut r\xe9pondre que par Oui, Non ou ???"}),O&&(0,l.jsxs)("div",{className:"mb-8 animate-in zoom-in duration-300",children:[l.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-widest mb-2",children:"Derni\xe8re r\xe9ponse du Ma\xeetre"}),l.jsx("div",{className:`inline-flex items-center justify-center px-8 py-4 rounded-xl text-2xl font-black border ${"yes"===O?"bg-emerald-500/20 text-emerald-400 border-emerald-500/50":"no"===O?"bg-rose-500/20 text-rose-400 border-rose-500/50":"bg-slate-500/20 text-slate-300 border-slate-500/50"}`,children:"yes"===O?"OUI":"no"===O?"NON":"???"})]}),"MASTER"===L?(0,l.jsxs)("div",{className:"flex flex-col gap-4 w-full",children:[(0,l.jsxs)("div",{className:"flex gap-2 justify-center w-full",children:[l.jsx(r.z,{onClick:()=>G("yes"),className:"flex-1 h-14 bg-emerald-600 hover:bg-emerald-500 text-lg font-bold",children:"OUI"}),l.jsx(r.z,{onClick:()=>G("no"),className:"flex-1 h-14 bg-rose-600 hover:bg-rose-500 text-lg font-bold",children:"NON"}),l.jsx(r.z,{onClick:()=>G("maybe"),className:"flex-1 h-14 bg-slate-600 hover:bg-slate-500 text-lg font-bold",children:"???"})]}),x&&(0,l.jsxs)(r.z,{onClick:J,className:"w-full h-12 bg-emerald-500/20 text-emerald-400 hover:bg-emerald-500/30 border border-emerald-500/50",children:[l.jsx(m.Z,{className:"w-4 h-4 mr-2"}),"Le mot a \xe9t\xe9 trouv\xe9 ! (Victoire Citoyens)"]})]}):l.jsx("p",{className:"text-sm text-slate-500 animate-pulse",children:"En attente d'une r\xe9ponse..."})]}),x&&(0,l.jsxs)(r.z,{onClick:()=>{x&&k({...R,phase:"vote"})},variant:"primary",className:"w-full max-w-sm rounded-xl py-6 bg-red-600 hover:bg-red-700",children:[l.jsx(h,{className:"w-5 h-5 mr-2"}),"Lancer le vote maintenant"]})]}),"vote"===Z&&(0,l.jsxs)("div",{className:"flex flex-col items-center gap-6 animate-in slide-in-from-bottom-4 duration-500",children:[(0,l.jsxs)("div",{className:"text-center",children:[l.jsx(p.Z,{className:"w-12 h-12 text-amber-500 mx-auto mb-4 animate-bounce"}),l.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Qui est l'Infiltr\xe9 ?"}),l.jsx("p",{className:"text-slate-400",children:"Votez pour la personne que vous soup\xe7onnez."})]}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 w-full",children:w.map(e=>(0,l.jsxs)("button",{onClick:()=>V(e.id),disabled:null!==_,className:`relative p-4 rounded-xl border-2 transition-all ${_===e.id?"bg-indigo-600/20 border-indigo-500 ring-2 ring-indigo-500/50":"bg-slate-800 border-white/5 hover:border-white/20 hover:bg-slate-700"}`,children:[l.jsx("div",{className:"font-bold text-lg text-white",children:e.name}),S[e.id]&&x&&l.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"A vot\xe9"}),_===e.id&&l.jsx("div",{className:"absolute top-2 right-2 bg-indigo-500 rounded-full p-1",children:l.jsx(m.Z,{className:"w-3 h-3 text-white"})})]},e.id))}),x&&l.jsx(r.z,{onClick:Q,className:"w-full max-w-sm mt-4 bg-indigo-600 hover:bg-indigo-500 py-6 rounded-xl",children:"Cl\xf4turer le vote"})]}),"end"===Z&&l.jsx("div",{className:"w-full max-w-2xl mx-auto animate-in zoom-in-95 duration-500",children:(0,l.jsxs)("div",{className:"bg-slate-900/80 backdrop-blur-xl rounded-3xl p-8 border border-white/10 text-center shadow-2xl overflow-hidden relative",children:[l.jsx("div",{className:`absolute inset-0 opacity-20 ${"CITOYENS"===F?"bg-emerald-500":"bg-rose-500"}`}),l.jsx("h2",{className:"text-4xl font-black text-white mb-2 relative z-10",children:"CITOYENS"===F?"\uD83C\uDF89 Les Citoyens gagnent !":"\uD83D\uDD75ï¸ L'Infiltr\xe9 gagne !"}),(0,l.jsxs)("div",{className:"mt-8 space-y-4 relative z-10 text-left bg-black/20 p-6 rounded-2xl",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center border-b border-white/10 pb-4",children:[l.jsx("span",{className:"text-slate-400",children:"Le mot \xe9tait"}),l.jsx("span",{className:"font-bold text-xl text-white",children:P})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center border-b border-white/10 pb-4",children:[l.jsx("span",{className:"text-slate-400",children:"L'Infiltr\xe9 \xe9tait"}),l.jsx("span",{className:"font-bold text-xl text-rose-400",children:w.find(e=>"INFILTR\xc9"===A[e.id])?.name||"Inconnu"})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-slate-400",children:"Suspect vot\xe9"}),l.jsx("span",{className:"font-bold text-xl text-slate-200",children:w.find(e=>e.id===$)?.name||"Aucun"})]})]}),(0,l.jsxs)("div",{className:"flex gap-4 w-full mt-8",children:[(0,l.jsxs)(r.z,{variant:"outline",className:"flex-1 h-14",onClick:()=>t.push(`/room/${e}`),children:[l.jsx(b.Z,{className:"w-5 h-5 mr-2"})," Retour au lobby"]}),x?(0,l.jsxs)(r.z,{onClick:Y,className:"flex-1 h-14 text-lg font-bold bg-white text-black hover:bg-slate-200",children:["Manche suivante ",l.jsx(g.Z,{className:"w-5 h-5 ml-2"})]}):(0,l.jsxs)(r.z,{className:"flex-1 h-14 bg-red-600 hover:bg-red-700 text-white",onClick:()=>t.push("/"),children:[l.jsx(f.Z,{className:"w-5 h-5 mr-2"})," Quitter"]})]})]})})]})]})})}function N({params:e,searchParams:t}){return l.jsx(w,{roomCode:e.code})}},5961:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(9224).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},5299:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(9224).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},2312:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(9224).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},7189:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(9224).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},1222:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(9224).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},2086:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(9224).Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},8120:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(9224).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},3485:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(9224).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},2254:(e,t,s)=>{e.exports=s(4767)},4651:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>r,__esModule:()=>a,default:()=>n});let l=(0,s(6843).createProxy)(String.raw`C:\Users\masso\Desktop\IttolecHub\app\games\infiltre\[code]\page.tsx`),{__esModule:a,$$typeof:r}=l,n=l.default}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),l=t.X(0,[638,643,334,616,755,466],()=>s(5298));module.exports=l})();