(()=>{var e={};e.id=618,e.ids=[618],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},5298:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>o});var a=s(482),l=s(9108),r=s(2563),n=s.n(r),i=s(8300),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let o=["",{children:["games",{children:["infiltre",{children:["[code]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4651)),"C:\\Users\\masso\\Desktop\\IttolecHub\\app\\games\\infiltre\\[code]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,5560)),"C:\\Users\\masso\\Desktop\\IttolecHub\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\masso\\Desktop\\IttolecHub\\app\\games\\infiltre\\[code]\\page.tsx"],x="/games/infiltre/[code]/page",u={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/games/infiltre/[code]/page",pathname:"/games/infiltre/[code]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},6536:(e,t,s)=>{Promise.resolve().then(s.bind(s,3925))},3925:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var a=s(5344),l=s(3729),r=s(3511),n=s(1973),i=s(6824),d=s(3485),o=s(7189),c=s(1222),x=s(9224);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,x.Z)("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),m=(0,x.Z)("Gavel",[["path",{d:"m14 13-7.5 7.5c-.83.83-2.17.83-3 0 0 0 0 0 0 0a2.12 2.12 0 0 1 0-3L11 10",key:"c9cbz0"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m9 7 8 8",key:"5jnvq1"}],["path",{d:"m21 11-8-8",key:"z4y7zo"}]]);var h=s(5961),p=s(2312),b=s(5299),g=s(4755);function f({roomCode:e}){let{gameState:t,isHost:s,players:x,playerId:f,startGame:j,updateRoundData:w,nextRound:v,submitAnswer:N}=(0,n.d)(e,"infiltre"),[y,k]=(0,l.useState)(0),[I,M]=(0,l.useState)(null),T=t?.round_data||{},q=T.queue||[],E=T.phase||"roles",C=T.roles||{},z=f?C[f]:void 0,A=t?.answers||{},R=f&&A[f]?A[f].answer:null,{word:Z,category:L,lastAnswer:S,winner:_,voteResult:D}=T,P=(0,l.useMemo)(()=>x.reduce((e,t)=>({...e,[t.name]:t.score}),{}),[x]);(0,l.useEffect)(()=>{if(t?.round_data?.countdown){let e=Math.ceil((t.round_data.countdown-Date.now())/1e3);if(e>0){M(e);let t=setInterval(()=>{M(e=>e&&e>1?e-1:0)},1e3);return()=>clearInterval(t)}M(null)}else M(null)},[t?.round_data?.countdown]),(0,l.useEffect)(()=>{if("question"===E&&T.endTime){let e=Math.ceil((T.endTime-Date.now())/1e3);k(e>0?e:0);let t=setInterval(()=>{k(e=>e<=1?0:e-1)},1e3);return()=>clearInterval(t)}},[E,T.endTime]);let O=async()=>{if(!s)return;let e=Date.now()+3e3;await w({...T,countdown:e}),setTimeout(async()=>{try{let e=await fetch("/api/games/infiltre?count=20"),t=await e.json();if(!Array.isArray(t)){g.Am.error("Erreur chargement mots");return}let s=t[0],a=t.slice(1),l=[...x].sort(()=>Math.random()-.5),r=l[0],n=l[1],i={};x.forEach(e=>{r&&e.id===r.id?i[e.id]="MASTER":n&&e.id===n.id?i[e.id]="INFILTR\xc9":i[e.id]="CITOYEN"}),await w({...T,countdown:null}),await j({queue:a,word:s.word,category:s.category,roles:i,phase:"question",lastAnswer:null,voteResult:null,winner:null,endTime:Date.now()+18e4})}catch(e){console.error(e),g.Am.error("Impossible de d\xe9marrer")}},3e3)},F=async()=>{if(!s)return;if(0===q.length){O();return}let e=q[0],t=q.slice(1),a=[...x].sort(()=>Math.random()-.5),l=a[0],r=a[1],n={};x.forEach(e=>{e.id===l?.id?n[e.id]="MASTER":e.id===r?.id?n[e.id]="INFILTR\xc9":n[e.id]="CITOYEN"}),await v({queue:t,word:e.word,category:e.category,roles:n,phase:"question",lastAnswer:null,voteResult:null,winner:null,endTime:Date.now()+18e4})},$=e=>{"MASTER"===z&&w({...T,lastAnswer:e})},U=async e=>{f&&e&&await N(e)},G=async()=>{if(!s)return;let e={};Object.values(A).forEach(t=>{let s=t.answer;s&&(e[s]=(e[s]||0)+1)});let t=0,a=null;Object.entries(e).forEach(([e,s])=>{s>t&&(t=s,a=e)});let l=Object.keys(C).find(e=>"INFILTR\xc9"===C[e]),r=a===l;w({...T,phase:"end",voteResult:a,winner:r?"CITOYENS":"INFILTR\xc9"})},Y=(0,l.useMemo)(()=>{let e=Math.floor(y/60),t=y%60;return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},[y]);return a.jsx(i.Z,{gameTitle:"L'Infiltr\xe9",roundCount:0,maxRounds:0,timer:Y,players:P,timeLeft:y,gameStarted:"roles"!==E,children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center w-full max-w-4xl mx-auto gap-8 animate-in fade-in duration-700",children:[I&&a.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm animate-in fade-in duration-300",children:a.jsx("div",{className:"text-9xl font-black text-white animate-pulse",children:I})}),"roles"===E?(0,a.jsxs)("div",{className:"flex flex-col items-center gap-6 text-center",children:[a.jsx("div",{className:"w-24 h-24 bg-indigo-500/20 rounded-full flex items-center justify-center animate-pulse",children:a.jsx(d.Z,{className:"w-12 h-12 text-indigo-400"})}),a.jsx("h2",{className:"text-3xl font-bold text-white",children:"Pr\xe9parez-vous \xe0 enqu\xeater"}),a.jsx("p",{className:"text-slate-400 max-w-md",children:"Un joueur est l'Infiltr\xe9. Il ne conna\xeet pas le mot secret. Les Citoyens doivent le d\xe9masquer sans trop en r\xe9v\xe9ler !"}),s?a.jsx(r.z,{onClick:O,size:"lg",className:"mt-4 bg-indigo-600 hover:bg-indigo-500 text-lg px-8 py-6 rounded-xl shadow-lg shadow-indigo-500/20",disabled:x.length<3,children:x.length<3?"En attente de joueurs (min 3)":"Distribuer les r\xf4les"}):(0,a.jsxs)("div",{className:"flex items-center gap-2 text-indigo-400 bg-indigo-950/30 px-4 py-2 rounded-full border border-indigo-500/30 animate-pulse",children:[a.jsx("div",{className:"w-2 h-2 bg-indigo-400 rounded-full"}),"En attente de l'h\xf4te..."]})]}):(0,a.jsxs)("div",{className:"w-full flex flex-col gap-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center bg-slate-900/50 p-4 rounded-xl border border-white/5",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-3 h-3 rounded-full animate-pulse ${"question"===E?"bg-emerald-500":"bg-amber-500"}`}),a.jsx("span",{className:"text-sm font-bold uppercase tracking-widest text-slate-300",children:"question"===E?"Phase de questions":"vote"===E?"Phase de vote":"R\xe9sultats"})]}),"question"===E&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-slate-400 font-mono",children:[a.jsx(o.Z,{className:"w-4 h-4"}),Y]})]}),(0,a.jsxs)("div",{className:"w-full bg-slate-800/50 rounded-2xl p-6 border border-white/10 flex flex-col items-center text-center relative overflow-hidden group",children:[a.jsx("div",{className:`absolute inset-0 opacity-10 ${"MASTER"===z?"bg-blue-600":"INFILTR\xc9"===z?"bg-red-600":"bg-emerald-600"}`}),a.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-widest mb-2 z-10",children:"Votre r\xf4le"}),a.jsx("h3",{className:`text-3xl font-black mb-4 z-10 ${"MASTER"===z?"text-blue-400":"INFILTR\xc9"===z?"text-red-400":"text-emerald-400"}`,children:"MASTER"===z?"MA\xceTRE DU JEU":"INFILTR\xc9"===z?"INFILTR\xc9":"CITOYEN"}),a.jsx("div",{className:"bg-black/40 p-4 rounded-xl w-full max-w-sm backdrop-blur-sm border border-white/5 z-10",children:"INFILTR\xc9"===z?(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[a.jsx(c.Z,{className:"w-8 h-8 text-slate-500 mx-auto mb-2"}),a.jsx("p",{className:"font-bold text-lg text-white",children:"Mot Secret Inconnu"}),a.jsx("p",{className:"text-sm text-slate-400",children:"Essayez de deviner le mot gr\xe2ce aux questions des autres !"})]}):(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[a.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest",children:"Le mot secret est"}),a.jsx("p",{className:"font-black text-2xl text-white tracking-tight",children:Z}),L&&a.jsx("p",{className:"text-xs text-blue-400 bg-blue-500/10 px-2 py-1 rounded-full self-center",children:L})]})})]}),"question"===E&&(0,a.jsxs)("div",{className:"flex flex-col items-center gap-6 animate-in slide-in-from-bottom-4 duration-500",children:[(0,a.jsxs)("div",{className:"w-full max-w-2xl bg-slate-900/50 rounded-2xl p-6 border border-white/5 text-center",children:[a.jsx(u,{className:"w-10 h-10 text-indigo-400 mx-auto mb-4"}),a.jsx("p",{className:"text-lg text-slate-300 mb-6",children:"Les joueurs posent des questions au Ma\xeetre du Jeu qui ne peut r\xe9pondre que par Oui, Non ou ???"}),S&&(0,a.jsxs)("div",{className:"mb-8 animate-in zoom-in duration-300",children:[a.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-widest mb-2",children:"Derni\xe8re r\xe9ponse du Ma\xeetre"}),a.jsx("div",{className:`inline-flex items-center justify-center px-8 py-4 rounded-xl text-2xl font-black border ${"yes"===S?"bg-emerald-500/20 text-emerald-400 border-emerald-500/50":"no"===S?"bg-rose-500/20 text-rose-400 border-rose-500/50":"bg-slate-500/20 text-slate-300 border-slate-500/50"}`,children:"yes"===S?"OUI":"no"===S?"NON":"???"})]}),"MASTER"===z?(0,a.jsxs)("div",{className:"flex gap-2 justify-center w-full",children:[a.jsx(r.z,{onClick:()=>$("yes"),className:"flex-1 h-14 bg-emerald-600 hover:bg-emerald-500 text-lg font-bold",children:"OUI"}),a.jsx(r.z,{onClick:()=>$("no"),className:"flex-1 h-14 bg-rose-600 hover:bg-rose-500 text-lg font-bold",children:"NON"}),a.jsx(r.z,{onClick:()=>$("maybe"),className:"flex-1 h-14 bg-slate-600 hover:bg-slate-500 text-lg font-bold",children:"???"})]}):a.jsx("p",{className:"text-sm text-slate-500 animate-pulse",children:"En attente d'une r\xe9ponse..."})]}),s&&(0,a.jsxs)(r.z,{onClick:()=>{s&&w({...T,phase:"vote"})},variant:"primary",className:"w-full max-w-sm rounded-xl py-6 bg-red-600 hover:bg-red-700",children:[a.jsx(m,{className:"w-5 h-5 mr-2"}),"Lancer le vote maintenant"]})]}),"vote"===E&&(0,a.jsxs)("div",{className:"flex flex-col items-center gap-6 animate-in slide-in-from-bottom-4 duration-500",children:[(0,a.jsxs)("div",{className:"text-center",children:[a.jsx(h.Z,{className:"w-12 h-12 text-amber-500 mx-auto mb-4 animate-bounce"}),a.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Qui est l'Infiltr\xe9 ?"}),a.jsx("p",{className:"text-slate-400",children:"Votez pour la personne que vous soup\xe7onnez."})]}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 w-full",children:x.map(e=>(0,a.jsxs)("button",{onClick:()=>U(e.id),disabled:null!==R,className:`relative p-4 rounded-xl border-2 transition-all ${R===e.id?"bg-indigo-600/20 border-indigo-500 ring-2 ring-indigo-500/50":"bg-slate-800 border-white/5 hover:border-white/20 hover:bg-slate-700"}`,children:[a.jsx("div",{className:"font-bold text-lg text-white",children:e.name}),A[e.id]&&s&&a.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"A vot\xe9"}),R===e.id&&a.jsx("div",{className:"absolute top-2 right-2 bg-indigo-500 rounded-full p-1",children:a.jsx(p.Z,{className:"w-3 h-3 text-white"})})]},e.id))}),s&&a.jsx(r.z,{onClick:G,className:"w-full max-w-sm mt-4 bg-indigo-600 hover:bg-indigo-500 py-6 rounded-xl",children:"Cl\xf4turer le vote"})]}),"end"===E&&a.jsx("div",{className:"w-full max-w-2xl mx-auto animate-in zoom-in-95 duration-500",children:(0,a.jsxs)("div",{className:"bg-slate-900/80 backdrop-blur-xl rounded-3xl p-8 border border-white/10 text-center shadow-2xl overflow-hidden relative",children:[a.jsx("div",{className:`absolute inset-0 opacity-20 ${"CITOYENS"===_?"bg-emerald-500":"bg-rose-500"}`}),a.jsx("h2",{className:"text-4xl font-black text-white mb-2 relative z-10",children:"CITOYENS"===_?"\uD83C\uDF89 Les Citoyens gagnent !":"\uD83D\uDD75ï¸ L'Infiltr\xe9 gagne !"}),(0,a.jsxs)("div",{className:"mt-8 space-y-4 relative z-10 text-left bg-black/20 p-6 rounded-2xl",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center border-b border-white/10 pb-4",children:[a.jsx("span",{className:"text-slate-400",children:"Le mot \xe9tait"}),a.jsx("span",{className:"font-bold text-xl text-white",children:Z})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center border-b border-white/10 pb-4",children:[a.jsx("span",{className:"text-slate-400",children:"L'Infiltr\xe9 \xe9tait"}),a.jsx("span",{className:"font-bold text-xl text-rose-400",children:x.find(e=>"INFILTR\xc9"===C[e.id])?.name||"Inconnu"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-slate-400",children:"Suspect vot\xe9"}),a.jsx("span",{className:"font-bold text-xl text-slate-200",children:x.find(e=>e.id===D)?.name||"Aucun"})]})]}),s&&(0,a.jsxs)(r.z,{onClick:F,className:"mt-8 w-full py-6 text-lg font-bold bg-white text-black hover:bg-slate-200 rounded-xl",children:["Manche suivante ",a.jsx(b.Z,{className:"w-5 h-5 ml-2"})]})]})})]})]})})}function j({params:e,searchParams:t}){return a.jsx(f,{roomCode:e.code})}},5961:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(9224).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},5299:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(9224).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},2312:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(9224).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},7189:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(9224).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},1222:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(9224).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},3485:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(9224).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},4651:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>r,__esModule:()=>l,default:()=>n});let a=(0,s(6843).createProxy)(String.raw`C:\Users\masso\Desktop\IttolecHub\app\games\infiltre\[code]\page.tsx`),{__esModule:l,$$typeof:r}=a,n=a.default}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[638,643,334,616,755,466],()=>s(5298));module.exports=a})();