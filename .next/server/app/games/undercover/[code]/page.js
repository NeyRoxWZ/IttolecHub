(()=>{var e={};e.id=697,e.ids=[697],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},7669:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>u,tree:()=>d});var a=s(482),r=s(9108),l=s(2563),n=s.n(l),i=s(8300),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);s.d(t,c);let d=["",{children:["games",{children:["undercover",{children:["[code]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,9907)),"C:\\Users\\masso\\Desktop\\IttolecHub\\app\\games\\undercover\\[code]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,5560)),"C:\\Users\\masso\\Desktop\\IttolecHub\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\Users\\masso\\Desktop\\IttolecHub\\app\\games\\undercover\\[code]\\page.tsx"],m="/games/undercover/[code]/page",x={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/games/undercover/[code]/page",pathname:"/games/undercover/[code]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9753:(e,t,s)=>{Promise.resolve().then(s.bind(s,3981))},3981:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var a=s(5344),r=s(3729),l=s(3511),n=s(5282),i=s(1973),c=s(6824),d=s(8822),o=s(1222),m=s(9224);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,m.Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var u=s(8852);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,m.Z)("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),p=(0,m.Z)("Skull",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["path",{d:"M8 20v2h8v-2",key:"ded4og"}],["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20",key:"xq9p5u"}]]);var g=s(4755);function f({roomCode:e}){let{gameState:t,isHost:s,players:m,playerId:f,updateSettings:v,startGame:b,updateRoundData:j,nextRound:y,submitAnswer:w,setGameStatus:N}=(0,i.d)(e,"undercover"),[k,I]=(0,r.useState)({rounds:1,mrWhiteEnabled:!0,discussionTime:60,voteTime:30,difficulty:"normal"}),[E,C]=(0,r.useState)(""),[M,T]=(0,r.useState)(""),[_,W]=(0,r.useState)(0),S=t?.round_data||{},R=S.phase||"setup",P=S.roles||{},z=f?P[f]:null,D=S.civilWord,q=S.undercoverWord,A=S.currentSpeaker,O=S.clues||[],V=S.alivePlayers||[],H=S.eliminated,Z=S.winner,L=t?.current_round||0,U=(0,r.useMemo)(()=>m.reduce((e,t)=>({...e,[t.name]:t.score}),{}),[m]),$="clues"===R&&A===f;f&&V.includes(f),(0,r.useEffect)(()=>{t?.settings&&I(e=>({...e,...t.settings}))},[t?.settings]),(0,r.useEffect)(()=>{s&&JSON.stringify(k)!==JSON.stringify(t?.settings)&&v(k)},[k,s,v,t?.settings]),(0,r.useEffect)(()=>{if(S.endTime){let e=Math.ceil((S.endTime-Date.now())/1e3);W(e>0?e:0)}},[S.endTime]),(0,r.useEffect)(()=>{if(_>0){let e=setInterval(()=>W(e=>Math.max(0,e-1)),1e3);return()=>clearInterval(e)}},[_]),(0,r.useEffect)(()=>{s&&(async()=>{"roles"===R&&0===_&&await j({...S,phase:"clues",currentSpeaker:V[0],endTime:null}),"discussion"===R&&0===_&&await j({...S,phase:"vote",endTime:Date.now()+1e3*k.voteTime}),"vote"===R&&0===_&&await F()})()},[s,R,_,S,V,k.voteTime]);let G=async()=>{if(s){if(m.length<3){g.Am.error("Il faut au moins 4 joueurs !");return}try{let e=await fetch(`/api/games/undercover?count=${k.rounds}`),t=await e.json();if(!t||0===t.length)return;let s=Array.isArray(t)?t[0]:t,a=Array.isArray(t)?t.slice(1):[],{newRoles:r,alive:l}=J(m,k.mrWhiteEnabled);await b({civilWord:s.civilWord,undercoverWord:s.undercoverWord,roles:r,alivePlayers:l,phase:"roles",clues:[],queue:a,endTime:Date.now()+5e3})}catch(e){console.error(e),g.Am.error("Erreur au d\xe9marrage")}}},J=(e,t)=>{let s=[...e].sort(()=>Math.random()-.5),a={},r=[],l=[...s],n=l.pop();if(n&&(a[n.id]="UNDERCOVER"),t&&l.length>0){let e=l.pop();e&&(a[e.id]="MR_WHITE")}return l.forEach(e=>a[e.id]="CIVIL"),s.forEach(e=>r.push(e.id)),{newRoles:a,alive:r}},F=async()=>{let e=t?.answers||{},s={};Object.values(e).forEach(e=>{"vote"===e.type&&e.targetId&&(s[e.targetId]=(s[e.targetId]||0)+1)});let a=0,r=null,l=!1;if(Object.entries(s).forEach(([e,t])=>{t>a?(a=t,r=e,l=!1):t===a&&(l=!0)}),l||!r){(0,g.Am)("\xc9galit\xe9 ! Personne n'est \xe9limin\xe9."),await j({...S,phase:"clues",currentSpeaker:V[0],clues:[]});return}if("MR_WHITE"===P[r]){await j({...S,eliminated:r,phase:"mrwhite_guess",endTime:Date.now()+3e4});return}X(r)},X=async e=>{let t=V.filter(t=>t!==e),s=t.map(e=>P[e]),a=s.includes("UNDERCOVER"),r=s.includes("MR_WHITE"),l=s.filter(e=>"CIVIL"===e).length;a||r?(a?1:0)+(r?1:0)>=l?await B("IMPOSTORS",t):await j({...S,eliminated:e,alivePlayers:t,phase:"clues",currentSpeaker:t[0],endTime:null}):await B("CIVILS",t)},B=async(e,t)=>{await j({...S,winner:e,phase:"results",alivePlayers:t})},K=async()=>{if(!s)return;let e=S.queue||[];if(0===e.length){await N("game_over");return}let t=e[0],a=e.slice(1),{newRoles:r,alive:l}=J(m,k.mrWhiteEnabled);await y({civilWord:t.civilWord,undercoverWord:t.undercoverWord,roles:r,alivePlayers:l,phase:"roles",clues:[],queue:a,endTime:Date.now()+5e3})},Q=async()=>{E.trim()&&(await w({type:"clue",text:E,timestamp:Date.now()}),C(""))},Y=async e=>{await w({type:"vote",targetId:e}),g.Am.success("Vote enregistr\xe9")},ee=async()=>{M.trim()&&await w({type:"guess",text:M})};return(0,r.useEffect)(()=>{s&&t?.answers&&(async()=>{let e=t.answers;if("clues"===R&&A){let t=e[A];if(t&&"clue"===t.type&&!O.find(e=>e.playerId===A&&e.text===t.text)){let e=[...O,{playerId:A,text:t.text,timestamp:t.timestamp}],s=(V.indexOf(A)+1)%V.length,a=V[s];0===s?await j({...S,clues:e,currentSpeaker:null,phase:"discussion",endTime:Date.now()+1e3*k.discussionTime}):await j({...S,clues:e,currentSpeaker:a})}}if("mrwhite_guess"===R&&H){let t=e[H];t&&"guess"===t.type&&(t.text.trim().toLowerCase()===(D||"").toLowerCase()?await B("MR_WHITE",V):await X(H))}})()},[s,t?.answers,R,A,O,V,k.discussionTime,H,D]),a.jsx(c.Z,{players:U,roundCount:L,maxRounds:k.rounds,timer:_>0?`${Math.floor(_/60)}:${(_%60).toString().padStart(2,"0")}`:"--:--",gameCode:e,gameTitle:"Undercover",isHost:s,gameStarted:"setup"!==R,onStartGame:G,timeLeft:_,children:(0,a.jsxs)("div",{className:"flex flex-col items-center w-full max-w-4xl mx-auto min-h-[400px]",children:["setup"===R&&(0,a.jsxs)("div",{className:"text-center space-y-6 bg-white/10 p-8 rounded-xl backdrop-blur-md",children:[a.jsx("h2",{className:"text-3xl font-bold",children:"Configuration"}),s?(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 text-left",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Manches"}),a.jsx(n.I,{type:"number",min:1,max:5,value:k.rounds,onChange:e=>I({...k,rounds:parseInt(e.target.value)})})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Mr. White"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(l.z,{variant:k.mrWhiteEnabled?"primary":"outline",onClick:()=>I({...k,mrWhiteEnabled:!0}),children:"Oui"}),a.jsx(l.z,{variant:k.mrWhiteEnabled?"outline":"primary",onClick:()=>I({...k,mrWhiteEnabled:!1}),children:"Non"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Discussion (sec)"}),a.jsx(n.I,{type:"number",min:30,max:180,value:k.discussionTime,onChange:e=>I({...k,discussionTime:parseInt(e.target.value)})})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Vote (sec)"}),a.jsx(n.I,{type:"number",min:15,max:60,value:k.voteTime,onChange:e=>I({...k,voteTime:parseInt(e.target.value)})})]}),a.jsx("div",{className:"col-span-full",children:a.jsx(l.z,{size:"lg",className:"w-full",onClick:G,children:"Lancer la partie"})})]}):a.jsx("p",{children:"En attente de l'h\xf4te..."})]}),"roles"===R&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full animate-in fade-in zoom-in",children:[a.jsx("h2",{className:"text-2xl mb-4",children:"Ton r\xf4le est..."}),(0,a.jsxs)("div",{className:"bg-black/40 p-8 rounded-full w-48 h-48 flex items-center justify-center border-4 border-white/20",children:["CIVIL"===z&&a.jsx(d.Z,{className:"w-20 h-20 text-blue-400"}),"UNDERCOVER"===z&&a.jsx(o.Z,{className:"w-20 h-20 text-red-400"}),"MR_WHITE"===z&&a.jsx(x,{className:"w-20 h-20 text-yellow-400"})]}),a.jsx("h3",{className:"text-4xl font-black mt-6 text-white uppercase",children:z?.replace("_"," ")}),"MR_WHITE"===z?a.jsx("p",{className:"mt-4 text-xl text-yellow-200",children:"Tu n'as pas de mot ! Essaye de deviner."}):(0,a.jsxs)("div",{className:"mt-6 text-center",children:[a.jsx("p",{className:"text-sm text-gray-400",children:"Ton mot secret :"}),a.jsx("p",{className:"text-3xl font-bold text-white bg-white/10 px-6 py-2 rounded-lg mt-2",children:"CIVIL"===z?D:q})]})]}),"clues"===R&&(0,a.jsxs)("div",{className:"w-full space-y-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-center",children:"Phase d'Indices"}),(0,a.jsxs)("div",{className:"bg-black/20 rounded-xl p-4 min-h-[200px] max-h-[400px] overflow-y-auto space-y-2",children:[O.map((e,t)=>{let s=m.find(t=>t.id===e.playerId);return(0,a.jsxs)("div",{className:"bg-white/5 p-3 rounded-lg flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"font-bold text-blue-300",children:[s?.name||"Inconnu",":"]}),(0,a.jsxs)("div",{className:"text-lg",children:['"',e.text,'"']})]},t)}),0===O.length&&a.jsx("p",{className:"text-gray-500 text-center italic mt-10",children:"Aucun indice pour le moment..."})]}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black to-transparent",children:a.jsx("div",{className:"max-w-4xl mx-auto",children:$?(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(n.I,{value:E,onChange:e=>C(e.target.value),placeholder:"\xc9cris ton indice...",className:"text-lg",autoFocus:!0}),a.jsx(l.z,{size:"lg",onClick:Q,children:"Envoyer"})]}):a.jsx("div",{className:"text-center p-4 bg-black/40 rounded-lg backdrop-blur text-gray-300",children:A?`C'est au tour de ${m.find(e=>e.id===A)?.name}...`:"Chargement..."})})})]}),"discussion"===R&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[a.jsx(u.Z,{className:"w-16 h-16 text-green-400 mb-4 animate-bounce"}),a.jsx("h2",{className:"text-3xl font-bold mb-2",children:"Discussion !"}),a.jsx("p",{className:"text-xl text-gray-300",children:"D\xe9battez et trouvez l'intrus."}),(0,a.jsxs)("div",{className:"mt-8 text-6xl font-black font-mono text-white/80",children:[_,"s"]}),(0,a.jsxs)("div",{className:"mt-8 w-full max-w-2xl bg-black/20 p-4 rounded-xl",children:[a.jsx("h3",{className:"text-sm text-gray-400 mb-2",children:"Rappel des indices :"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-left",children:O.map((e,t)=>{let s=m.find(t=>t.id===e.playerId);return(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("span",{className:"font-bold text-blue-300",children:[s?.name,":"]})," ",e.text]},t)})})]})]}),"vote"===R&&(0,a.jsxs)("div",{className:"w-full text-center",children:[a.jsx("h2",{className:"text-3xl font-bold mb-6 text-red-400",children:"Votez pour \xe9liminer !"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:V.map(e=>{let t=m.find(t=>t.id===e);return t&&e!==f?(0,a.jsxs)("button",{onClick:()=>Y(e),className:"bg-white/10 hover:bg-red-500/20 border-2 border-white/10 hover:border-red-500 p-6 rounded-xl transition-all flex flex-col items-center gap-2 group",children:[a.jsx(d.Z,{className:"w-12 h-12 text-gray-400 group-hover:text-red-400"}),a.jsx("span",{className:"font-bold text-lg",children:t?.name})]},e):null})})]}),"mrwhite_guess"===R&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[a.jsx(x,{className:"w-20 h-20 text-yellow-400 mb-4"}),a.jsx("h2",{className:"text-3xl font-bold mb-2",children:"Mr. White a \xe9t\xe9 d\xe9masqu\xe9 !"}),a.jsx("p",{className:"mb-6",children:"Il a une derni\xe8re chance de gagner en devinant le mot des Civils."}),"MR_WHITE"===z&&H===f?(0,a.jsxs)("div",{className:"flex gap-2 w-full max-w-md",children:[a.jsx(n.I,{value:M,onChange:e=>T(e.target.value),placeholder:"Devine le mot..."}),a.jsx(l.z,{onClick:ee,children:"Valider"})]}):a.jsx("p",{className:"animate-pulse",children:"Mr. White r\xe9fl\xe9chit..."})]}),("results"===R||"game_over"===R)&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full animate-in zoom-in",children:["CIVILS"===Z&&a.jsx(h,{className:"w-24 h-24 text-blue-400 mb-4"}),"IMPOSTORS"===Z&&a.jsx(p,{className:"w-24 h-24 text-red-400 mb-4"}),"MR_WHITE"===Z&&a.jsx(x,{className:"w-24 h-24 text-yellow-400 mb-4"}),(0,a.jsxs)("h2",{className:"text-4xl font-black mb-2",children:["CIVILS"===Z&&"Les Civils ont gagn\xe9 !","IMPOSTORS"===Z&&"Les Imposteurs ont gagn\xe9 !","MR_WHITE"===Z&&"Mr. White a gagn\xe9 !"]}),(0,a.jsxs)("div",{className:"bg-white/10 p-6 rounded-xl mt-8 w-full max-w-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4 border-b border-white/10 pb-2",children:[a.jsx("span",{children:"Mot Civil :"}),a.jsx("span",{className:"font-bold text-xl",children:D})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4 border-b border-white/10 pb-2",children:[a.jsx("span",{children:"Mot Undercover :"}),a.jsx("span",{className:"font-bold text-xl",children:q})]}),(0,a.jsxs)("div",{className:"space-y-2 mt-4",children:[a.jsx("h3",{className:"text-sm text-gray-400",children:"R\xf4les :"}),m.map(e=>(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:e.name}),a.jsx("span",{className:`font-bold ${"CIVIL"===P[e.id]?"text-blue-400":"UNDERCOVER"===P[e.id]?"text-red-400":"text-yellow-400"}`,children:P[e.id]})]},e.id))]})]}),s&&a.jsx(l.z,{size:"lg",className:"mt-8",onClick:K,children:L<k.rounds?"Manche Suivante":"Retour au menu"})]})]})})}function v({params:e,searchParams:t}){return a.jsx(f,{roomCode:e.code})}},5282:(e,t,s)=>{"use strict";s.d(t,{I:()=>l});var a=s(5344),r=s(1626);let l=(0,s(3729).forwardRef)(({className:e,...t},s)=>a.jsx("input",{ref:s,className:(0,r.cn)("flex h-10 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm","placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","disabled:cursor-not-allowed disabled:opacity-50","dark:border-slate-600 dark:bg-slate-800 dark:text-slate-100 dark:placeholder:text-slate-400",e),...t}));l.displayName="Input"},1222:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(9224).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},8852:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(9224).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},8822:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(9224).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},9907:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>r,default:()=>n});let a=(0,s(6843).createProxy)(String.raw`C:\Users\masso\Desktop\IttolecHub\app\games\undercover\[code]\page.tsx`),{__esModule:r,$$typeof:l}=a,n=a.default}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[638,643,373,616,755,466],()=>s(7669));module.exports=a})();