"use strict";(()=>{var e={};e.id=984,e.ids=[984],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2661:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>y,originalPathname:()=>w,patchFetch:()=>k,requestAsyncStorage:()=>f,routeModule:()=>h,serverHooks:()=>g,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>v});var n={};r.r(n),r.d(n,{GET:()=>m,dynamic:()=>l});var a=r(5419),o=r(9108),s=r(9678),i=r(8070);let l="force-dynamic";function u(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim()}async function c(e){try{let t=await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(e)}&entity=song&limit=50`);if(!t.ok)return[];return(await t.json()).results.filter(t=>u(t.artistName).includes(u(e))||u(e).includes(u(t.artistName)))}catch(e){return console.error("iTunes API error",e),[]}}async function p(e,t){try{let r=`https://api.lyrics.ovh/v1/${encodeURIComponent(e)}/${encodeURIComponent(t)}`,n=await fetch(r);if(n.ok)return(await n.json()).lyrics;let a=t.replace(/\(.*\)/g,"").replace(/feat\..*/i,"").trim();if(a!==t&&(r=`https://api.lyrics.ovh/v1/${encodeURIComponent(e)}/${encodeURIComponent(a)}`,(n=await fetch(r)).ok))return(await n.json()).lyrics;return null}catch(e){return null}}async function m(e){let{searchParams:t}=new URL(e.url),r=t.get("artist"),n=parseInt(t.get("count")||"1",10);if(!r)return i.Z.json({error:"Le param\xe8tre 'artist' est requis"},{status:400});try{let e=await c(r);if(0===e.length)return i.Z.json({error:"Artiste non trouv\xe9 sur iTunes."},{status:404});for(let t=e.length-1;t>0;t--){let r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}let t=[],a=new Set;for(let r of e){if(t.length>=n)break;if(a.has(r.trackName.toLowerCase()))continue;let e=await p(r.artistName,r.trackName);if(e){if(e.length<50||e.includes("Instrumental"))continue;let n=function(e){let t=e.split(/\n\n+/).filter(e=>{let t=e.split("\n").length;return t>=2&&t<=6});if(t.length>0)return t[Math.floor(Math.random()*t.length)];let r=e.split("\n").filter(e=>e.trim().length>0);if(r.length<4)return e;let n=Math.floor(Math.random()*(r.length-4));return r.slice(n,n+4).join("\n")}(e);n&&(t.push({artist:r.artistName,title:r.trackName,cover:r.artworkUrl100?.replace("100x100","600x600"),extract:n}),a.add(r.trackName.toLowerCase()))}}if(0===t.length)return i.Z.json({error:"Impossible de trouver des paroles pour cet artiste."},{status:404});return i.Z.json(t)}catch(e){return console.error("Erreur API LyricsGuessr:",e),i.Z.json({error:"Erreur serveur"},{status:500})}}let h=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/games/lyrics/route",pathname:"/api/games/lyrics",filename:"route",bundlePath:"app/api/games/lyrics/route"},resolvedPagePath:"C:\\Users\\masso\\Desktop\\IttolecHub\\app\\api\\games\\lyrics\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:f,staticGenerationAsyncStorage:d,serverHooks:g,headerHooks:y,staticGenerationBailout:v}=h,w="/api/games/lyrics/route";function k(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:d})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[638,206],()=>r(2661));module.exports=n})();