"use strict";(()=>{var e={};e.id=984,e.ids=[984],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2661:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>y,originalPathname:()=>k,patchFetch:()=>v,requestAsyncStorage:()=>h,routeModule:()=>f,serverHooks:()=>g,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>w});var n={};r.r(n),r.d(n,{GET:()=>m,dynamic:()=>l});var a=r(5419),s=r(9108),i=r(9678),o=r(8070);let l="force-dynamic";function u(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim()}async function c(e){try{let t=await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(e)}&entity=song&limit=100`);if(!t.ok)return[];return(await t.json()).results.filter(t=>u(t.artistName).includes(u(e))||u(e).includes(u(t.artistName)))}catch(e){return console.error("iTunes API error",e),[]}}async function p(e,t){try{let r=`${e} ${t}`,n=`https://lrclib.net/api/search?q=${encodeURIComponent(r)}`,a=await fetch(n);if(!a.ok)return null;let s=await a.json();if(!Array.isArray(s)||0===s.length)return null;let i=s.find(t=>{let r=u(t.artistName),n=u(e);return r.includes(n)||n.includes(r)});if(i)return i.plainLyrics||i.syncedLyrics||null;return null}catch(e){return console.error("Error fetching from lrclib:",e),null}}async function m(e){let{searchParams:t}=new URL(e.url),r=t.get("artist"),n=parseInt(t.get("count")||"1",10);if(!r)return o.Z.json({error:"Le param\xe8tre 'artist' est requis"},{status:400});try{let e=r.split(",").map(e=>e.trim()).filter(e=>e.length>0),t=[];for(let r of e){let e=await c(r);t=t.concat(e)}if(0===t.length)return o.Z.json({error:"Aucun artiste trouv\xe9 sur iTunes."},{status:404});for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}let a=[],s=new Set;for(let e of t){if(a.length>=n)break;if(s.has(e.trackName.toLowerCase()))continue;let t=await p(e.artistName,e.trackName);if(t){if(t.length<50||t.includes("Instrumental"))continue;let r=function(e){let t=e.split(/\n\n+/).filter(e=>{let t=e.split("\n").length;return t>=2&&t<=6});if(t.length>0)return t[Math.floor(Math.random()*t.length)];let r=e.split("\n").filter(e=>e.trim().length>0);if(r.length<4)return e;let n=Math.floor(Math.random()*(r.length-4));return r.slice(n,n+4).join("\n")}(t);r&&(a.push({artist:e.artistName,title:e.trackName,cover:e.artworkUrl100?.replace("100x100","600x600"),extract:r}),s.add(e.trackName.toLowerCase()))}}if(0===a.length)return o.Z.json({error:"Impossible de trouver des paroles pour cet artiste."},{status:404});return o.Z.json(a)}catch(e){return console.error("Erreur API LyricsGuessr:",e),o.Z.json({error:"Erreur serveur"},{status:500})}}let f=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/games/lyrics/route",pathname:"/api/games/lyrics",filename:"route",bundlePath:"app/api/games/lyrics/route"},resolvedPagePath:"C:\\Users\\masso\\Desktop\\IttolecHub\\app\\api\\games\\lyrics\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:h,staticGenerationAsyncStorage:d,serverHooks:g,headerHooks:y,staticGenerationBailout:w}=f,k="/api/games/lyrics/route";function v(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:d})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[638,206],()=>r(2661));module.exports=n})();