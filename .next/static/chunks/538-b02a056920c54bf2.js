(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[538],{3008:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2898).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6141:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2898).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},6020:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2898).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},8957:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2898).Z)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]])},2104:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2898).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},9313:function(e,t,s){"use strict";s.d(t,{z:function(){return l}});var a=s(7437),r=s(1657);let l=(0,s(2265).forwardRef)((e,t)=>{let{children:s,className:l,variant:n="primary",size:d="md",...c}=e;return(0,a.jsx)("button",{ref:t,className:(0,r.cn)("inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500 dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700",secondary:"bg-slate-200 text-slate-900 hover:bg-slate-300 focus:ring-slate-500 dark:bg-slate-700 dark:text-slate-100 dark:hover:bg-slate-600",outline:"border border-slate-300 text-slate-700 hover:bg-slate-50 focus:ring-slate-500 dark:border-slate-600 dark:text-slate-200 dark:hover:bg-slate-800 dark:bg-transparent"}[n],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[d],l),...c,children:s})});l.displayName="Button"},1543:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(7437),r=s(1657);function l(e){let{children:t,className:s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700","text-slate-800 dark:text-slate-100 shadow-sm hover:shadow-md transition-shadow duration-200","rounded-2xl",s),children:t})}},4203:function(e,t,s){"use strict";s.d(t,{I:function(){return l}});var a=s(7437),r=s(1657);let l=(0,s(2265).forwardRef)((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("input",{ref:t,className:(0,r.cn)("flex h-10 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm","placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","disabled:cursor-not-allowed disabled:opacity-50","dark:border-slate-600 dark:bg-slate-800 dark:text-slate-100 dark:placeholder:text-slate-400",s),...l})});l.displayName="Input"},9538:function(e,t,s){"use strict";s.d(t,{Z:function(){return k}});var a=s(7437),r=s(2265),l=s(1543),n=s(9313),d=s(4518),c=s(6141),o=s(3008),i=s(2104),u=s(8957),x=s(4033);function m(e){let{imageUrl:t,revealed:s,blurLevel:r}=e;return(0,a.jsx)("div",{className:"relative w-full h-full flex-1 flex items-center justify-center",children:(0,a.jsx)("img",{src:t,alt:"Pokemon \xe0 deviner",className:"transition-all duration-1000 object-contain max-w-full max-h-full ".concat(s?"blur-none":"blur-[".concat(r,"px]")),style:{imageRendering:"pixelated"}})})}var h=s(4203),p=s(6020);function b(e){let{guess:t,setGuess:s,handleGuess:r,disabled:l}=e;return(0,a.jsxs)("form",{onSubmit:r,className:"flex gap-2",children:[(0,a.jsx)(h.I,{type:"text",placeholder:"Nom du Pok\xe9mon...",value:t,onChange:e=>s(e.target.value),className:"rounded-xl flex-grow",disabled:l}),(0,a.jsx)(n.z,{type:"submit",className:"rounded-xl",disabled:l,children:(0,a.jsx)(p.Z,{className:"h-5 w-5"})})]})}var f=s(6690),g=s(6027);function k(e){var t,s;let{roomCode:h,settings:p}=e;if(!h)return(0,a.jsx)("div",{children:"Code de room non sp\xe9cifi\xe9."});(0,x.useRouter)();let[k,v]=(0,r.useState)(null),[y,j]=(0,r.useState)(""),[N,w]=(0,r.useState)([]),[Z,I]=(0,r.useState)(!1),[S,C]=(0,r.useState)(null),[M,z]=(0,r.useState)(!1),[E,R]=(0,r.useState)([]),[_,q]=(0,r.useState)(!1),[H,J]=(0,r.useState)(0),[L,O]=(0,r.useState)(5),[V,P]=(0,r.useState)(30),[A,X]=(0,r.useState)(null),[B,D]=(0,r.useState)(20),[G,T]=(0,r.useState)(9),{broadcast:Y,messages:F}=(0,d.r)(h,"pokeguessr"),U="true"===sessionStorage.getItem("isHost"),Q=sessionStorage.getItem("playerName")||"Anonyme";(0,r.useEffect)(()=>{p&&(p.rounds&&O(parseInt(p.rounds)),p.time&&P(parseInt(p.time)),p.gen&&T(parseInt(p.gen)))},[p]);let W=async()=>{if(U){if(H>=L){q(!0),Y({type:"game_end",data:{players:E}});return}try{let e=await fetch("/api/games/pokemon?gen=".concat(G)),t=await e.json(),s={type:"round_start",data:t};Y(s),K(s),P((null==p?void 0:p.time)?parseInt(p.time):30),D(20),X(null)}catch(e){console.error("Erreur d\xe9marrage manche:",e)}}},K=e=>{if(e)switch(e.type){case"round_start":v(e.data),I(!0),C(null),z(!1),w([]),j(""),J(e=>e+1);break;case"player_guess":w(t=>{let s=[...t,e.data.player];return Array.from(new Set(s))});break;case"round_end":S||(C(e.data.winner),z(!0));break;case"game_end":q(!0),e.data.players&&R(e.data.players)}};return((0,r.useEffect)(()=>{K(F[F.length-1])},[F]),(0,r.useEffect)(()=>{let e;return Z&&!M&&V>0&&(e=setInterval(()=>{P(e=>e<=1?(z(!0),0):e-1)},1e3)),()=>clearInterval(e)},[Z,M,V]),(0,r.useEffect)(()=>{let e;return Z&&!M&&(e=setInterval(()=>{D(e=>Math.max(0,e-2))},1e4)),()=>clearInterval(e)},[Z,M]),(0,r.useEffect)(()=>{Q&&0===E.length&&R([{name:Q,score:0}])},[Q]),_)?(0,a.jsx)(g.Z,{players:E,roomCode:h,onReplay:()=>{q(!1),R([]),J(0),I(!1),C(null),z(!1),w([]),j(""),v(null)}}):(0,a.jsx)("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 text-slate-800 dark:text-slate-100 p-4 sm:p-6 game-layout",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto flex flex-col gap-4 sm:gap-6",children:[Z&&!M&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 rounded-2xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-400",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Temps restant"})]}),(0,a.jsxs)("span",{className:"text-sm font-bold text-slate-800 dark:text-slate-100",children:[V,"s"]})]}),(0,a.jsx)("div",{className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-red-500 dark:bg-red-600 rounded-full transition-all duration-1000",style:{width:"".concat(V/((null==p?void 0:p.time)?parseInt(p.time,10):30)*100,"%")}})})]}),null!==A&&(0,a.jsxs)("div",{className:"p-3 rounded-2xl flex items-center gap-2 ".concat(A?"bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900/40 dark:text-red-200"),children:[A?(0,a.jsx)(o.Z,{className:"h-4 w-4"}):(0,a.jsx)(i.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-medium",children:A?"Correct !":"Incorrect"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100",children:"PokeGuessr"}),(0,a.jsxs)("p",{className:"text-sm text-slate-600 dark:text-slate-400 mt-1",children:["Manche ",H,"/",L," • Score : ",null!==(s=null===(t=E.find(e=>e.name===Q))||void 0===t?void 0:t.score)&&void 0!==s?s:0]})]}),!Z&&U&&(0,a.jsxs)(l.Z,{className:"p-6 sm:p-8 text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 text-slate-800 dark:text-slate-100",children:"Pr\xeat \xe0 deviner ?"}),(0,a.jsx)(n.z,{onClick:W,className:"rounded-2xl bg-red-600 hover:bg-red-700 text-white px-8 py-3",children:"Commencer la partie"})]}),!Z&&!U&&(0,a.jsxs)(l.Z,{className:"p-6 sm:p-8 text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 text-slate-800 dark:text-slate-100",children:"En attente de l'h\xf4te"}),(0,a.jsx)("p",{className:"text-slate-600 dark:text-slate-400",children:"L'h\xf4te va lancer la partie."})]}),Z&&(0,a.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[k&&(0,a.jsx)(m,{imageUrl:k.imageUrl,revealed:M,blurLevel:B}),!S&&(0,a.jsx)(b,{guess:y,setGuess:j,handleGuess:e=>{if(e.preventDefault(),!y.trim()||!k||S)return;let t=Object.values(k.names).some(e=>e.toLowerCase()===y.toLowerCase().trim());if(X(t),setTimeout(()=>X(null),2e3),Y({type:"player_guess",data:{player:Q,isCorrect:t}}),t&&!S){R(e=>{let t=[...e],s=t.find(e=>e.name===Q);return s?s.score+=10:t.push({name:Q,score:10}),t});let e={type:"round_end",data:{winner:Q}};Y(e),K(e)}j("")},disabled:!!S||N.includes(Q)}),(0,a.jsx)(f.Z,{answeredPlayers:N}),S&&(0,a.jsxs)(l.Z,{className:"p-6 sm:p-8 text-center bg-green-100 dark:bg-green-900/40 border-green-200 dark:border-green-800",children:[(0,a.jsx)(u.Z,{className:"h-12 w-12 text-amber-500 mx-auto mb-4"}),(0,a.jsxs)("h2",{className:"text-xl sm:text-2xl font-bold text-green-800 dark:text-green-200",children:[S," a trouv\xe9 !"]}),(0,a.jsxs)("p",{className:"text-slate-700 dark:text-slate-300 mt-2",children:["R\xe9ponse : ",(0,a.jsx)("span",{className:"font-bold text-slate-900 dark:text-slate-100",children:null==k?void 0:k.names.fr})]}),U&&(0,a.jsx)(n.z,{onClick:W,className:"mt-6 rounded-2xl",children:H>=L?"Voir les scores":"Manche suivante"})]})]})]})})}},6690:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(7437),r=s(7972);function l(e){let{answeredPlayers:t}=e;return(0,a.jsx)("div",{className:"flex flex-wrap justify-center gap-2",children:t.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-1 px-3 py-1 bg-slate-200 dark:bg-slate-700 rounded-full text-sm text-slate-800 dark:text-slate-100",children:[(0,a.jsx)(r.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[e," a r\xe9pondu ✅"]})]},e))})}},6027:function(e,t,s){"use strict";s.d(t,{Z:function(){return m}});var a=s(7437),r=s(2265),l=s(1543),n=s(9313),d=s(8957),c=s(7972),o=s(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,o.Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),u=(0,o.Z)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var x=s(4033);function m(e){let{players:t,roomCode:s,onReplay:o}=e,m=(0,x.useRouter)(),[h,p]=(0,r.useState)([]);(0,r.useEffect)(()=>{p([...t].sort((e,t)=>t.score-e.score))},[t]);let b=e=>{switch(e){case 1:return(0,a.jsx)(d.Z,{className:"h-6 w-6 text-yellow-500"});case 2:return(0,a.jsx)(d.Z,{className:"h-5 w-5 text-gray-400"});case 3:return(0,a.jsx)(d.Z,{className:"h-5 w-5 text-orange-600"});default:return(0,a.jsx)("span",{className:"text-lg font-bold text-slate-500",children:e})}},f=e=>{switch(e){case 1:return"bg-amber-100 dark:bg-amber-900/40 border-amber-300 dark:border-amber-700 text-slate-800 dark:text-slate-100";case 2:return"bg-slate-100 dark:bg-slate-800 border-slate-300 dark:border-slate-600 text-slate-800 dark:text-slate-100";case 3:return"bg-orange-100 dark:bg-orange-900/40 border-orange-300 dark:border-orange-700 text-slate-800 dark:text-slate-100";default:return"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-800 dark:text-slate-100"}};return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 dark:from-slate-900 dark:to-purple-950 p-4 sm:p-6 game-layout text-slate-800 dark:text-slate-100",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsxs)("div",{className:"text-center mb-6 sm:mb-8",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-4xl font-bold text-blue-600 dark:text-blue-400 mb-2",children:"Partie termin\xe9e !"}),(0,a.jsxs)("p",{className:"text-slate-600 dark:text-slate-400",children:["Room : ",s]})]}),(0,a.jsxs)(l.Z,{className:"p-4 sm:p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-xl sm:text-2xl font-semibold mb-4 text-center text-slate-800 dark:text-slate-100",children:"Classement final"}),(0,a.jsx)("div",{className:"space-y-3",children:h.map((e,t)=>{let s=t+1;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 sm:p-4 rounded-xl border-2 ".concat(f(s)," transition-all duration-200 hover:scale-[1.02]"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 shrink-0",children:b(s)}),(0,a.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,a.jsx)(c.Z,{className:"h-5 w-5 text-slate-500 dark:text-slate-400 shrink-0"}),(0,a.jsx)("span",{className:"font-semibold text-slate-800 dark:text-slate-100 truncate",children:e.name})]})]}),(0,a.jsxs)("div",{className:"text-right shrink-0",children:[(0,a.jsx)("span",{className:"text-xl sm:text-2xl font-bold text-blue-600 dark:text-blue-400",children:e.score}),(0,a.jsx)("span",{className:"text-sm text-slate-500 dark:text-slate-400 ml-1",children:"pts"})]})]},e.name)})})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)(n.z,{onClick:()=>{sessionStorage.removeItem("playerName"),sessionStorage.removeItem("isHost"),m.push("/")},variant:"outline",className:"flex-1 rounded-xl py-3",children:[(0,a.jsx)(i,{className:"h-5 w-5 mr-2"}),"Quitter"]}),(0,a.jsxs)(n.z,{onClick:()=>{o()},className:"flex-1 rounded-xl py-3 bg-green-600 hover:bg-green-700 text-white",children:[(0,a.jsx)(u,{className:"h-5 w-5 mr-2"}),"Rejouer"]})]})]})})}},4518:function(e,t,s){"use strict";s.d(t,{r:function(){return l}});var a=s(2265);let r=(0,s(3226).eI)("https://vyatvqwsoqalbnbcmhqm.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ5YXR2cXdzb3FhbGJuYmNtaHFtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE3ODkzMDcsImV4cCI6MjA4NzM2NTMwN30.KoTP3iOZmvbzB8RjHlmWIyvdMVpfqoia3-MQxbdL1sY");function l(e,t){let[s,l]=(0,a.useState)([]),[n,d]=(0,a.useState)([]);return(0,a.useEffect)(()=>{let s=r.channel("room:".concat(e));return s.on("presence",{event:"sync"},()=>{l(Object.values(s.presenceState()).flat())}).on("presence",{event:"join"},e=>{let{key:t,newPresences:s}=e;console.log("Nouveau joueur:",s)}).on("presence",{event:"leave"},e=>{let{key:t,leftPresences:s}=e;console.log("Joueur parti:",s)}).on("broadcast",{event:t},e=>{let{payload:t}=e;d(e=>[...e,t])}).subscribe(async e=>{"SUBSCRIBED"===e&&await s.track({playerName:sessionStorage.getItem("playerName")||"Anonyme",gameType:t,joinedAt:new Date().toISOString()})}),()=>{s.unsubscribe()}},[e,t]),{broadcast:s=>{r.channel("room:".concat(e)).send({type:"broadcast",event:t,payload:s})},presence:s,messages:n}}},1657:function(e,t,s){"use strict";s.d(t,{cn:function(){return l}});var a=s(7042),r=s(4769);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}},4033:function(e,t,s){e.exports=s(5313)}}]);