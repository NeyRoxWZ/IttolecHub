(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[935],{3008:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2898).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6020:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2898).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},8957:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2898).Z)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]])},2104:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2898).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},612:function(e,t,s){Promise.resolve().then(s.bind(s,5598))},5598:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var a=s(7437),r=s(2265),l=s(1543),n=s(9313),d=s(4518),o=s(3008),c=s(2104),i=s(6020),u=s(6690),x=s(6027);function m(e){return e.toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ")}function h(e){var t,s;let{roomCode:h,settings:p}=e;if(!h)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center text-slate-800 dark:text-slate-200",children:"Code de room non sp\xe9cifi\xe9."});let[b,g]=(0,r.useState)(""),[f,k]=(0,r.useState)([]),[v,y]=(0,r.useState)(!1),[j,N]=(0,r.useState)([]),[w,Z]=(0,r.useState)(!1),[C,S]=(0,r.useState)(0),[I,z]=(0,r.useState)(5),[M,E]=(0,r.useState)(null),[_,q]=(0,r.useState)(""),[R,H]=(0,r.useState)([]),{broadcast:J,messages:O}=(0,d.r)(h,"completeguessr"),B="true"===sessionStorage.getItem("isHost"),F=sessionStorage.getItem("playerName")||"Anonyme";(0,r.useEffect)(()=>{(null==p?void 0:p.rounds)&&z(parseInt(p.rounds,10))},[p]);let P=(0,r.useCallback)(async()=>{if(B){if(C>=I){Z(!0),J({type:"game_end",data:{players:j}});return}try{var e;let t=(null==p?void 0:p.lang)||"fr",s=await fetch("/api/games/autocomplete?lang=".concat(encodeURIComponent(t)));if(!s.ok)throw Error("API error");let a=await s.json();if(a.error||!a.prompt||!(null===(e=a.suggestions)||void 0===e?void 0:e.length))throw Error(a.error||"Pas de suggestions");let r={type:"round_start",data:{prompt:a.prompt,suggestions:a.suggestions.map(e=>({text:e.text,found:!1}))}};J(r),q(a.prompt),H(a.suggestions.map(e=>({text:e.text,found:!1}))),y(!0),k([]),g(""),E(null),S(e=>e+1)}catch(e){console.error("Erreur d\xe9marrage manche Compl\xe8teGuessr:",e)}}},[B,C,I,J,j,null==p?void 0:p.lang]),T=(0,r.useCallback)(e=>{var t,s,a;if(e)switch(e.type){case"round_start":q(e.data.prompt||""),H((e.data.suggestions||[]).map(e=>({...e,found:!1}))),y(!0),k([]),g(""),S(e=>e+1),E(null);break;case"player_guess":k(t=>{var s;let a=null===(s=e.data)||void 0===s?void 0:s.player;return a&&!t.includes(a)?[...t,a]:t});break;case"suggestion_found":(null===(t=e.data)||void 0===t?void 0:t.suggestions)&&H(e.data.suggestions),(null===(s=e.data)||void 0===s?void 0:s.player)&&N(t=>{let s=[...t],a=s.find(t=>t.name===e.data.player);return a?a.score+=10:s.push({name:e.data.player,score:10}),s});break;case"game_end":Z(!0),(null===(a=e.data)||void 0===a?void 0:a.players)&&N(e.data.players)}},[]);return((0,r.useEffect)(()=>{let e=O[O.length-1];e&&T(e)},[O,T]),(0,r.useEffect)(()=>{F&&0===j.length&&N([{name:F,score:0}])},[F,j.length]),w)?(0,a.jsx)(x.Z,{players:j,roomCode:h,onReplay:()=>{Z(!1),N([]),S(0),y(!1),q(""),H([]),k([]),g("")}}):(0,a.jsx)("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 text-slate-800 dark:text-slate-100 p-4 sm:p-6 game-layout",children:(0,a.jsxs)("div",{className:"max-w-3xl mx-auto flex flex-col gap-4 sm:gap-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:"Compl\xe8teGuessr"}),(0,a.jsxs)("p",{className:"text-sm text-slate-600 dark:text-slate-400 mt-1",children:["Manche ",C,"/",I," • Ton score :"," ",null!==(s=null===(t=j.find(e=>e.name===F))||void 0===t?void 0:t.score)&&void 0!==s?s:0]})]}),!v&&B&&(0,a.jsxs)(l.Z,{className:"p-8 text-center rounded-2xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 text-slate-800 dark:text-slate-100",children:"Pr\xeat \xe0 jouer ?"}),(0,a.jsx)(n.z,{onClick:P,className:"rounded-2xl bg-blue-600 hover:bg-blue-700 text-white px-8 py-3",children:"Commencer la partie"})]}),!v&&!B&&(0,a.jsxs)(l.Z,{className:"p-8 text-center rounded-2xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 text-slate-800 dark:text-slate-100",children:"En attente de l'h\xf4te"}),(0,a.jsx)("p",{className:"text-slate-600 dark:text-slate-400",children:"L'h\xf4te va lancer la partie."})]}),v&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.Z,{className:"p-6 rounded-2xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700",children:[(0,a.jsx)("p",{className:"text-2xl md:text-3xl font-semibold text-slate-800 dark:text-slate-100 text-center leading-relaxed",children:_}),(0,a.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-2 text-center",children:"Trouve une des suggestions Google (phrase exacte ou fin de phrase)."})]}),(0,a.jsxs)(l.Z,{className:"p-6 rounded-2xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-slate-600 dark:text-slate-400 mb-3",children:"Suggestions trouv\xe9es"}),(0,a.jsx)("ul",{className:"space-y-2",children:R.map((e,t)=>(0,a.jsx)("li",{className:"flex items-center gap-2 py-2 border-b border-slate-100 dark:border-slate-700 last:border-0",children:e.found?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.Z,{className:"h-5 w-5 text-green-600 dark:text-green-400 shrink-0"}),(0,a.jsxs)("span",{className:"text-slate-800 dark:text-slate-100",children:[_.replace(/\.\.\.$/,"")," ",e.text]}),e.foundBy&&(0,a.jsxs)("span",{className:"text-xs text-slate-500 dark:text-slate-400 ml-auto",children:["→ ",e.foundBy]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.Z,{className:"h-5 w-5 text-slate-300 dark:text-slate-600 shrink-0"}),(0,a.jsx)("span",{className:"text-slate-400 dark:text-slate-500 italic",children:"???"})]})},t))})]}),null!==M&&(0,a.jsxs)("div",{className:"rounded-2xl p-4 flex items-center gap-2 ".concat(M?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200"),children:[M?(0,a.jsx)(o.Z,{className:"h-5 w-5"}):(0,a.jsx)(c.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"font-medium",children:M?"Correct !":"Pas dans la liste."})]}),(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!b.trim()||!R.length)return;let t=m(b),s=_.replace(/\.\.\.$/,"").trim(),a=-1;for(let e=0;e<R.length;e++){if(R[e].found)continue;let r="".concat(s," ").concat(R[e].text);if(t===m(R[e].text)||t===m(r)){a=e;break}}if(J({type:"player_guess",data:{player:F,guess:b.trim()}}),k(e=>e.includes(F)?e:[...e,F]),a>=0){E(!0),setTimeout(()=>E(null),2e3);let e=R.map((e,t)=>t===a?{...e,found:!0,foundBy:F}:e);H(e),N(e=>{let t=[...e],s=t.find(e=>e.name===F);return s?s.score+=10:t.push({name:F,score:10}),t}),J({type:"suggestion_found",data:{index:a,player:F,suggestions:e}})}else E(!1),setTimeout(()=>E(null),2e3);g("")},className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",placeholder:"Ta r\xe9ponse...",value:b,onChange:e=>g(e.target.value),className:"flex-1 rounded-2xl border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 px-4 py-3 text-slate-900 dark:text-slate-100 placeholder:text-slate-400 dark:placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)(n.z,{type:"submit",className:"rounded-2xl bg-blue-600 hover:bg-blue-700 text-white px-6",disabled:!b.trim(),children:(0,a.jsx)(i.Z,{className:"h-5 w-5"})})]}),(0,a.jsx)(u.Z,{answeredPlayers:f}),B&&(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(n.z,{onClick:P,variant:"outline",className:"rounded-2xl",children:C>=I?"Voir les r\xe9sultats":"Manche suivante"})})]})]})})}function p(e){let{params:t,searchParams:s}=e;return(0,a.jsx)(h,{roomCode:t.code,settings:s})}},9313:function(e,t,s){"use strict";s.d(t,{z:function(){return l}});var a=s(7437),r=s(1657);let l=(0,s(2265).forwardRef)((e,t)=>{let{children:s,className:l,variant:n="primary",size:d="md",...o}=e;return(0,a.jsx)("button",{ref:t,className:(0,r.cn)("inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500 dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700",secondary:"bg-slate-200 text-slate-900 hover:bg-slate-300 focus:ring-slate-500 dark:bg-slate-700 dark:text-slate-100 dark:hover:bg-slate-600",outline:"border border-slate-300 text-slate-700 hover:bg-slate-50 focus:ring-slate-500 dark:border-slate-600 dark:text-slate-200 dark:hover:bg-slate-800 dark:bg-transparent"}[n],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[d],l),...o,children:s})});l.displayName="Button"},1543:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(7437),r=s(1657);function l(e){let{children:t,className:s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700","text-slate-800 dark:text-slate-100 shadow-sm hover:shadow-md transition-shadow duration-200","rounded-2xl",s),children:t})}},6690:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(7437),r=s(7972);function l(e){let{answeredPlayers:t}=e;return(0,a.jsx)("div",{className:"flex flex-wrap justify-center gap-2",children:t.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-1 px-3 py-1 bg-slate-200 dark:bg-slate-700 rounded-full text-sm text-slate-800 dark:text-slate-100",children:[(0,a.jsx)(r.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[e," a r\xe9pondu ✅"]})]},e))})}},6027:function(e,t,s){"use strict";s.d(t,{Z:function(){return m}});var a=s(7437),r=s(2265),l=s(1543),n=s(9313),d=s(8957),o=s(7972),c=s(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,c.Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),u=(0,c.Z)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var x=s(4033);function m(e){let{players:t,roomCode:s,onReplay:c}=e,m=(0,x.useRouter)(),[h,p]=(0,r.useState)([]);(0,r.useEffect)(()=>{p([...t].sort((e,t)=>t.score-e.score))},[t]);let b=e=>{switch(e){case 1:return(0,a.jsx)(d.Z,{className:"h-6 w-6 text-yellow-500"});case 2:return(0,a.jsx)(d.Z,{className:"h-5 w-5 text-gray-400"});case 3:return(0,a.jsx)(d.Z,{className:"h-5 w-5 text-orange-600"});default:return(0,a.jsx)("span",{className:"text-lg font-bold text-slate-500",children:e})}},g=e=>{switch(e){case 1:return"bg-amber-100 dark:bg-amber-900/40 border-amber-300 dark:border-amber-700 text-slate-800 dark:text-slate-100";case 2:return"bg-slate-100 dark:bg-slate-800 border-slate-300 dark:border-slate-600 text-slate-800 dark:text-slate-100";case 3:return"bg-orange-100 dark:bg-orange-900/40 border-orange-300 dark:border-orange-700 text-slate-800 dark:text-slate-100";default:return"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-800 dark:text-slate-100"}};return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 dark:from-slate-900 dark:to-purple-950 p-4 sm:p-6 game-layout text-slate-800 dark:text-slate-100",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsxs)("div",{className:"text-center mb-6 sm:mb-8",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-4xl font-bold text-blue-600 dark:text-blue-400 mb-2",children:"Partie termin\xe9e !"}),(0,a.jsxs)("p",{className:"text-slate-600 dark:text-slate-400",children:["Room : ",s]})]}),(0,a.jsxs)(l.Z,{className:"p-4 sm:p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-xl sm:text-2xl font-semibold mb-4 text-center text-slate-800 dark:text-slate-100",children:"Classement final"}),(0,a.jsx)("div",{className:"space-y-3",children:h.map((e,t)=>{let s=t+1;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 sm:p-4 rounded-xl border-2 ".concat(g(s)," transition-all duration-200 hover:scale-[1.02]"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 shrink-0",children:b(s)}),(0,a.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,a.jsx)(o.Z,{className:"h-5 w-5 text-slate-500 dark:text-slate-400 shrink-0"}),(0,a.jsx)("span",{className:"font-semibold text-slate-800 dark:text-slate-100 truncate",children:e.name})]})]}),(0,a.jsxs)("div",{className:"text-right shrink-0",children:[(0,a.jsx)("span",{className:"text-xl sm:text-2xl font-bold text-blue-600 dark:text-blue-400",children:e.score}),(0,a.jsx)("span",{className:"text-sm text-slate-500 dark:text-slate-400 ml-1",children:"pts"})]})]},e.name)})})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)(n.z,{onClick:()=>{sessionStorage.removeItem("playerName"),sessionStorage.removeItem("isHost"),m.push("/")},variant:"outline",className:"flex-1 rounded-xl py-3",children:[(0,a.jsx)(i,{className:"h-5 w-5 mr-2"}),"Quitter"]}),(0,a.jsxs)(n.z,{onClick:()=>{c()},className:"flex-1 rounded-xl py-3 bg-green-600 hover:bg-green-700 text-white",children:[(0,a.jsx)(u,{className:"h-5 w-5 mr-2"}),"Rejouer"]})]})]})})}},4518:function(e,t,s){"use strict";s.d(t,{r:function(){return l}});var a=s(2265);let r=(0,s(3226).eI)("https://vyatvqwsoqalbnbcmhqm.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ5YXR2cXdzb3FhbGJuYmNtaHFtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE3ODkzMDcsImV4cCI6MjA4NzM2NTMwN30.KoTP3iOZmvbzB8RjHlmWIyvdMVpfqoia3-MQxbdL1sY");function l(e,t){let[s,l]=(0,a.useState)([]),[n,d]=(0,a.useState)([]);return(0,a.useEffect)(()=>{let s=r.channel("room:".concat(e));return s.on("presence",{event:"sync"},()=>{l(Object.values(s.presenceState()).flat())}).on("presence",{event:"join"},e=>{let{key:t,newPresences:s}=e;console.log("Nouveau joueur:",s)}).on("presence",{event:"leave"},e=>{let{key:t,leftPresences:s}=e;console.log("Joueur parti:",s)}).on("broadcast",{event:t},e=>{let{payload:t}=e;d(e=>[...e,t])}).subscribe(async e=>{"SUBSCRIBED"===e&&await s.track({playerName:sessionStorage.getItem("playerName")||"Anonyme",gameType:t,joinedAt:new Date().toISOString()})}),()=>{s.unsubscribe()}},[e,t]),{broadcast:s=>{r.channel("room:".concat(e)).send({type:"broadcast",event:t,payload:s})},presence:s,messages:n}}},1657:function(e,t,s){"use strict";s.d(t,{cn:function(){return l}});var a=s(7042),r=s(4769);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}},4033:function(e,t,s){e.exports=s(5313)}},function(e){e.O(0,[61,293,971,938,744],function(){return e(e.s=612)}),_N_E=e.O()}]);